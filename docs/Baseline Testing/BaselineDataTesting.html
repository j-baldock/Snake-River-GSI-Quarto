<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Snake River GSI - 3&nbsp; Baseline Testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Baseline Fst/BaselineFst.html" rel="next">
<link href="../Baseline Relatedness/BaselineRelatedness.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean"
}
</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="../site_libs/leaflet-1.3.1/leaflet.js"></script><link href="../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="../site_libs/proj4-2.6.2/proj4.min.js"></script><script src="../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="../site_libs/leaflet-binding-2.2.2/leaflet.js"></script><script src="../site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script><script src="../site_libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script><link href="../site_libs/HomeButton-0.0.1/home-button.css" rel="stylesheet">
<script src="../site_libs/HomeButton-0.0.1/home-button.js"></script><script src="../site_libs/HomeButton-0.0.1/easy-button-src.min.js"></script><script src="../site_libs/clipboard-0.0.1/setClipboardText.js"></script><link href="../site_libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet">
<link href="../site_libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet">
<script src="../site_libs/core-js-2.5.3/shim.min.js"></script><script src="../site_libs/react-18.2.0/react.min.js"></script><script src="../site_libs/react-18.2.0/react-dom.min.js"></script><script src="../site_libs/reactwidget-2.0.0/react-tools.js"></script><link href="../site_libs/reactable-0.4.4/reactable.css" rel="stylesheet">
<script src="../site_libs/reactable-binding-0.4.4/reactable.js"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Baseline Relatedness/BaselineRelatedness.html">Genetic stock identification</a></li><li class="breadcrumb-item"><a href="../Baseline Testing/BaselineDataTesting.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Baseline Testing</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Snake River GSI</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Genetic stock identification</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Baseline Relatedness/BaselineRelatedness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Baseline Relatedness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Baseline Testing/BaselineDataTesting.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Baseline Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Baseline Fst/BaselineFst.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Baseline Fst</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GSI Analysis/GSIAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">GSI Analysis</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Landscape attributes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Landscape Covariates/Flowline Distance/FlowlineDist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Flowline Distance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Landscape Covariates/Groundwater/GroundwaterIndex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Groundwater</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Landscape Covariates/Barriers/Barriers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Barriers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Landscape Covariates/Landcover/Landcover.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Barriers</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#data" id="toc-data" class="nav-link active" data-scroll-target="#data"><span class="header-section-number">3.1</span> Data</a>
  <ul class="collapse">
<li><a href="#format-data" id="toc-format-data" class="nav-link" data-scroll-target="#format-data"><span class="header-section-number">3.1.1</span> Format data</a></li>
  <li><a href="#filter-data" id="toc-filter-data" class="nav-link" data-scroll-target="#filter-data"><span class="header-section-number">3.1.2</span> Filter data</a></li>
  </ul>
</li>
  <li><a href="#define-reporting-units" id="toc-define-reporting-units" class="nav-link" data-scroll-target="#define-reporting-units"><span class="header-section-number">3.2</span> Define reporting units</a></li>
  <li><a href="#delineate-sample-type" id="toc-delineate-sample-type" class="nav-link" data-scroll-target="#delineate-sample-type"><span class="header-section-number">3.3</span> Delineate sample type</a></li>
  <li>
<a href="#self-assignment-tests" id="toc-self-assignment-tests" class="nav-link" data-scroll-target="#self-assignment-tests"><span class="header-section-number">3.4</span> Self-assignment tests</a>
  <ul class="collapse">
<li><a href="#run-self-assignment" id="toc-run-self-assignment" class="nav-link" data-scroll-target="#run-self-assignment"><span class="header-section-number">3.4.1</span> Run self-assignment</a></li>
  <li><a href="#inspect-z-scores" id="toc-inspect-z-scores" class="nav-link" data-scroll-target="#inspect-z-scores"><span class="header-section-number">3.4.2</span> Inspect z-scores</a></li>
  <li><a href="#self-assignment-likelihood" id="toc-self-assignment-likelihood" class="nav-link" data-scroll-target="#self-assignment-likelihood"><span class="header-section-number">3.4.3</span> Self-assignment likelihood</a></li>
  <li><a href="#accuracy-and-efficiency" id="toc-accuracy-and-efficiency" class="nav-link" data-scroll-target="#accuracy-and-efficiency"><span class="header-section-number">3.4.4</span> Accuracy and efficiency</a></li>
  <li><a href="#confusion-matrix" id="toc-confusion-matrix" class="nav-link" data-scroll-target="#confusion-matrix"><span class="header-section-number">3.4.5</span> Confusion matrix</a></li>
  </ul>
</li>
  <li>
<a href="#simulated-mixtures" id="toc-simulated-mixtures" class="nav-link" data-scroll-target="#simulated-mixtures"><span class="header-section-number">3.5</span> Simulated mixtures</a>
  <ul class="collapse">
<li><a href="#run-simulations" id="toc-run-simulations" class="nav-link" data-scroll-target="#run-simulations"><span class="header-section-number">3.5.1</span> Run simulations</a></li>
  <li><a href="#global-results" id="toc-global-results" class="nav-link" data-scroll-target="#global-results"><span class="header-section-number">3.5.2</span> Global results</a></li>
  <li><a href="#by-reporting-group" id="toc-by-reporting-group" class="nav-link" data-scroll-target="#by-reporting-group"><span class="header-section-number">3.5.3</span> By reporting group</a></li>
  <li><a href="#z-scores" id="toc-z-scores" class="nav-link" data-scroll-target="#z-scores"><span class="header-section-number">3.5.4</span> Z-scores</a></li>
  </ul>
</li>
  <li><a href="#simulations" id="toc-simulations" class="nav-link" data-scroll-target="#simulations"><span class="header-section-number">3.6</span> 100% Simulations</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Baseline Relatedness/BaselineRelatedness.html">Genetic stock identification</a></li><li class="breadcrumb-item"><a href="../Baseline Testing/BaselineDataTesting.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Baseline Testing</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Baseline Testing</span>
</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>Purpose: test baseline reporting groups for accuracy and efficiency using 100% simulations, self-assignment tests, and simulated mixtures. up</p>
<section id="data" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="data">
<span class="header-section-number">3.1</span> Data</h2>
<p>Load raw genotype data, sibling IDs to drop (full siblings), and gps locations (to sort)</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/usr_gsi_gtseq_plusmeta.csv"</span><span class="op">)</span></span>
<span><span class="va">drop_sibs</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Relatedness/UpperSnakeRiver_GTseq_Baseline_DropFullSiblings.csv"</span><span class="op">)</span></span>
<span><span class="va">gps</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Landscape Covariates/RepUnit_LatLong.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gps_sp</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">gps</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lon"</span>, <span class="st">"lat"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span><span class="fu">mapview</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mapview/man/mapView.html">mapview</a></span><span class="op">(</span><span class="va">gps_sp</span>, col.regions <span class="op">=</span> <span class="st">"blue"</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-bb466da19d8a6628935b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-bb466da19d8a6628935b">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["point",440]},{"method":"addCircleMarkers","args":[[43.21356,43.82523,43.807227,43.666833,42.94309,43.30566,43.86268,43.24928,43.85941,43.246684,43.43554,43.55226,43.676575,43.736445,43.611865,43.550601,42.96197,43.75892,43.23103,43.684036,43.28527,43.32097,43.45621,43.55007,43.53982,43.45036,43.55408,43.283152,43.34876,43.5773784,43.06569,43.3504,43.85349,43.729944,43.14805,43.54686,43.44196,43.88506,43.85965,43.766876,43.26637,43.62104,43.68275,43.74837,43.780469,43.777245,43.86169,43.46924,43.55138,43.678163,43.00559,43.29092],[-110.78208,-110.35208,-110.178741,-110.702522,-110.71308,-110.51166,-110.28188,-110.77872,-110.25135,-110.498562,-110.82925,-110.25895,-110.707392,-110.66881,-110.429336,-110.404471,-110.723,-110.60262,-110.42322,-110.582611,-110.80263,-110.75784,-110.86316,-110.2461,-110.7257,-110.84711,-110.29047,-110.531771,-110.43899,-110.714828,-110.47446,-110.68303,-110.4444,-110.345755,-110.78316,-110.78555,-110.88266,-110.20756,-110.506105,-110.449342,-110.50858,-110.40103,-110.70136,-110.31922,-110.380987,-110.287325,-110.58398,-110.81539,-110.79136,-110.705296,-110.80309,-110.67188],6,null,"gps_sp",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"point","stroke":true,"color":"#333333","weight":1,"opacity":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9],"fill":true,"fillColor":"#0000FF","fillOpacity":[0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6]},null,null,["<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>bailey_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>2&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>blackrock_lower&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>3&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>blackrock_upper&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>4&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>blacktail_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>5&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>blindbull_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>6&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>boulder_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>7&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>box_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>8&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>cabin_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>9&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>clear_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>10&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>cliff_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>11&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>cody_bluecrane&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>12&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>cottonwood_grosventre&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>13&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>cottonwood_nps&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>14&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>cowboycabin_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>15&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>crystal_lower&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>16&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>crystal_upper&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>17&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>deadman_greys&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>18&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>deadmansbar_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>19&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>dell_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>20&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>ditch_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>21&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>dog_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>22&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>fall_coburn&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>23&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>fish_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>24&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>fish_grosventre&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>25&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>flat_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>26&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>fordspring_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>27&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>goosewing_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>28&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>granite_lower&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>29&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>granite_upper&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>30&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>grosventre_lower&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>31&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>hoback_upper&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>32&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>horse_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>33&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>lava_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>34&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>leidy_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>35&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>littlegreys_steer&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>36&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>lowerbarbc_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>37&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>mosquito_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>38&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>northbuffalofork_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>39&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>pacific_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>40&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>rock_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>41&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>shoal_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>42&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>slate_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>43&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>snakeriversidechannel_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>44&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>spread_southfork&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>45&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>spread_uppermainstem&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>46&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>spreadnf_flagstaff&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>47&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>spring_nps&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>48&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>spring_tss&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>49&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>threechannel_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>50&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>upperbarbc_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>51&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>white_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>52&emsp;<\/td><\/tr><tr><td>1<\/td><th>repunit&emsp;<\/th><td>willow_NA&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>"],{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["bailey_NA","blackrock_lower","blackrock_upper","blacktail_NA","blindbull_NA","boulder_NA","box_NA","cabin_NA","clear_NA","cliff_NA","cody_bluecrane","cottonwood_grosventre","cottonwood_nps","cowboycabin_NA","crystal_lower","crystal_upper","deadman_greys","deadmansbar_NA","dell_NA","ditch_NA","dog_NA","fall_coburn","fish_NA","fish_grosventre","flat_NA","fordspring_NA","goosewing_NA","granite_lower","granite_upper","grosventre_lower","hoback_upper","horse_NA","lava_NA","leidy_NA","littlegreys_steer","lowerbarbc_NA","mosquito_NA","northbuffalofork_NA","pacific_NA","rock_NA","shoal_NA","slate_NA","snakeriversidechannel_NA","spread_southfork","spread_uppermainstem","spreadnf_flagstaff","spring_nps","spring_tss","threechannel_NA","upperbarbc_NA","white_NA","willow_NA"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-110.88266,42.94309,-110.178741,43.88506,true,"gps_sp","Zoom to gps_sp","<strong> gps_sp <\/strong>","bottomright"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],"gps_sp",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[42.94309,43.88506],"lng":[-110.88266,-110.178741]},"fitBounds":[42.94309,-110.88266,43.88506,-110.178741,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</div>
</div>
<section id="format-data" class="level3" data-number="3.1.1"><h3 data-number="3.1.1" class="anchored" data-anchor-id="format-data">
<span class="header-section-number">3.1.1</span> Format data</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gt_mat</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span> <span class="co"># pull out sequence data</span></span>
<span><span class="va">gt_mat</span><span class="op">[</span><span class="va">gt_mat</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span> <span class="co"># change the missing data to NA</span></span>
<span></span>
<span><span class="co"># ID rows corresponding to baseline vs mixture samples</span></span>
<span><span class="va">ref_indv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Category</span> <span class="op">==</span> <span class="st">"baseline"</span><span class="op">)</span> </span>
<span><span class="va">mix_indv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Category</span> <span class="op">==</span> <span class="st">"mixture"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># create data for sample_type column </span></span>
<span><span class="va">sample_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"reference"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sample_type</span><span class="op">[</span><span class="va">mix_indv</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"mixture"</span></span>
<span></span>
<span><span class="co"># create data for reporting unit column</span></span>
<span><span class="va">repunit</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">Pop</span></span>
<span><span class="va">repunit</span><span class="op">[</span><span class="va">mix_indv</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co"># create data for collection column (same as reporting unit, except for mixture samples)</span></span>
<span><span class="va">collection</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">Pop</span></span>
<span></span>
<span><span class="co"># IDFG EFGL sample ID</span></span>
<span><span class="va">indiv</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">SampNumber</span></span>
<span></span>
<span><span class="co"># combine into singe data frame</span></span>
<span><span class="va">input_data</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span><span class="va">sample_type</span>, <span class="va">repunit</span>, <span class="va">collection</span>, <span class="va">indiv</span><span class="op">)</span></span>
<span><span class="va">all_input</span> <span class="op">&lt;-</span> <span class="fu">bind_cols</span><span class="op">(</span><span class="va">input_data</span>, <span class="va">gt_mat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ensure that baseline individuals that are likely BKT are not included (4 from NF Spread Ck and 1 from Upper Mainstem Spread Ck)</span></span>
<span><span class="va">all_input</span> <span class="op">&lt;-</span> <span class="va">all_input</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">indiv</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"OclVARI23G_0013"</span>, <span class="st">"OclVARI23G_0012"</span>, <span class="st">"OclVARI23G_0010"</span>, <span class="st">"OclVARI23G_0011"</span>, <span class="st">"OclVARI23G_0099"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="filter-data" class="level3" data-number="3.1.2"><h3 data-number="3.1.2" class="anchored" data-anchor-id="filter-data">
<span class="header-section-number">3.1.2</span> Filter data</h3>
<p>Drop putative “mixture” reporting groups</p>
<ul>
<li>snake_murieranch collection from ~ 2km downstream of UBBC/Blacktail…preliminary self-assignment tests show these samples assign to those streams</li>
<li>lake_na collection from upper lake creek…preliminary self-assignment tests show these samples assign to UBBC, Blacktail, and Cottonwood.
<ul>
<li>Which makes sense as pretty much all flow at this location derives from Granite Diversion Ditch, which pulls water from just downstream of Moose.</li>
<li>Additionally, spawning and rearing capacity is likely very limited in this system as flow is all but turned off by late summer/early fall after irrigation season.</li>
</ul>
</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_input</span> <span class="op">&lt;-</span> <span class="va">all_input</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">repunit</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"snake_murieranch"</span>, <span class="st">"lake_NA"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "bacon_NA"                   "bailey_NA"                 
 [3] "bear_NA"                    "blackrock_lower"           
 [5] "blackrock_upper"            "blacktail_NA"              
 [7] "blindbull_NA"               "bluecrane_ford"            
 [9] "boulder_NA"                 "box_NA"                    
[11] "cabin_NA"                   "clear_NA"                  
[13] "cliff_NA"                   "coburn_NA"                 
[15] "cody_moment"                "cottonwood_grosventre"     
[17] "cottonwood_nps"             "cowboycabin_NA"            
[19] "cowboycabin_springchannels" "crystal_lower"             
[21] "crystal_upper"              "deadmansbar_NA"            
[23] "dell_NA"                    "ditch_NA"                  
[25] "dog_NA"                     "fall_lower"                
[27] "fall_upper"                 "fish_grosventre"           
[29] "fish_lower"                 "fish_upper"                
[31] "flagstaff_NA"               "flat_NA"                   
[33] "fordspring_NA"              "goosewing_NA"              
[35] "granite_lower"              "granite_upper"             
[37] "grosventre_lower"           "hoback_upper"              
[39] "horse_NA"                   "jack_NA"                   
[41] "lava_NA"                    "leidy_NA"                  
[43] "littlegreys_lower"          "littlegreys_upper"         
[45] "lowerbarbc_NA"              "mosquito_NA"               
[47] "northbuffalofork_NA"        "deadman_greys"             
[49] "pacific_lower"              "pacific_upper"             
[51] "rock_NA"                    "schwabacher_NA"            
[53] "sheep_NA"                   "shoal_NA"                  
[55] "slate_lower"                "slate_upper"               
[57] NA                           "snakeriversidechannel_NA"  
[59] "southbuffalofork_NA"        "spread_northfork"          
[61] "spread_southfork"           "spread_uppermainstem"      
[63] "spring_nps"                 "spring_tss"                
[65] "steer_NA"                   "threechannel_eastfork"     
[67] "threechannel_westfork"      "upperbarbc_NA"             
[69] "white_NA"                   "willow_NA"                 </code></pre>
</div>
</div>
<p>Drop big sibling groups (see BaselineRelatedness.R): retain 2 full siblings per family per Ostergren et al.&nbsp;(2020) Molecular Ecology Resources</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_input</span> <span class="op">&lt;-</span> <span class="va">all_input</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">indiv</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">drop_sibs</span><span class="op">$</span><span class="va">drop_sibs</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Write out data files</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># write out</span></span>
<span><span class="fu">write_csv</span><span class="op">(</span><span class="va">all_input</span>, <span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/UpperSnakeRiver_GTseq_InputData_NoSibs.csv"</span><span class="op">)</span></span>
<span><span class="va">all_input</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/UpperSnakeRiver_GTseq_InputData_NoSibs.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="define-reporting-units" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="define-reporting-units">
<span class="header-section-number">3.2</span> Define reporting units</h2>
<p>Drop and redefine reporting units based on sample size, geographic proximity, and low genetic differentiation among proximate populations.</p>
<p>First, identify and combine reporting groups with low sample sizes.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_input</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">repunit</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">repunit</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarise</span><span class="op">(</span>ct <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">reactable</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">add_title</span><span class="op">(</span><span class="st">"Raw, unaltered reporting unit (population) sample sizes."</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<h1 style="color:#000;background:#FFFFFF;text-align:left;font-size:32px;font-style:normal;font-weight:bold;text-decoration:;letter-spacing:px;word-spacing:px;text-transform:;text-shadow:;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px">Raw, unaltered reporting unit (population) sample sizes.</h1>
<div class="reactable html-widget html-fill-item" id="htmlwidget-946926e22807c5af5c7e" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-946926e22807c5af5c7e">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"repunit":["bacon_NA","bailey_NA","bear_NA","blackrock_lower","blackrock_upper","blacktail_NA","blindbull_NA","bluecrane_ford","boulder_NA","box_NA","cabin_NA","clear_NA","cliff_NA","coburn_NA","cody_moment","cottonwood_grosventre","cottonwood_nps","cowboycabin_NA","cowboycabin_springchannels","crystal_lower","crystal_upper","deadman_greys","deadmansbar_NA","dell_NA","ditch_NA","dog_NA","fall_lower","fall_upper","fish_grosventre","fish_lower","fish_upper","flagstaff_NA","flat_NA","fordspring_NA","goosewing_NA","granite_lower","granite_upper","grosventre_lower","hoback_upper","horse_NA","jack_NA","lava_NA","leidy_NA","littlegreys_lower","littlegreys_upper","lowerbarbc_NA","mosquito_NA","northbuffalofork_NA","pacific_lower","pacific_upper","rock_NA","schwabacher_NA","sheep_NA","shoal_NA","slate_lower","slate_upper","snakeriversidechannel_NA","southbuffalofork_NA","spread_northfork","spread_southfork","spread_uppermainstem","spring_nps","spring_tss","steer_NA","threechannel_eastfork","threechannel_westfork","upperbarbc_NA","white_NA","willow_NA"],"ct":[4,29,3,29,27,42,30,2,29,16,37,37,38,3,16,34,40,14,9,30,29,26,25,31,23,46,33,39,17,42,40,5,30,13,10,38,17,38,38,24,5,34,16,25,31,40,40,40,32,30,20,2,4,40,29,5,31,2,9,36,33,25,15,21,19,20,39,14,40]},"columns":[{"id":"repunit","name":"repunit","type":"character"},{"id":"ct","name":"ct","type":"numeric"}],"dataKey":"41d07803a79014fc5dd55c24da5a9757"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Redefine reporting groups for groups with ~low sample size AND low self-assignment rates calculated from raw data OR collections from different locations within the same stream.</p>
<p>After running 2nd round of self-assignment tests, drop the groupings that led to reduced self-assignment rates relative to Will’s original work treating collections as reporting groups</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"bluecrane_ford"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"cody_bluecrane"</span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"cody_moment"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"cody_bluecrane"</span></span>
<span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"cowboycabin_springchannels"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"cowboycabin_NA"</span></span>
<span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"threechannel_eastfork"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"threechannel_NA"</span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"threechannel_westfork"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"threechannel_NA"</span></span>
<span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"fish_lower"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"fish_NA"</span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"fish_upper"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"fish_NA"</span></span>
<span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"slate_lower"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"slate_NA"</span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"slate_upper"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"slate_NA"</span></span>
<span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"spread_northfork"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"spreadnf_flagstaff"</span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"flagstaff_NA"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"spreadnf_flagstaff"</span></span>
<span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"fall_upper"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"fall_coburn"</span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"fall_lower"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"fall_coburn"</span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"coburn_NA"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"fall_coburn"</span></span>
<span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"littlegreys_lower"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"littlegreys_steer"</span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"littlegreys_upper"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"littlegreys_steer"</span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"steer_NA"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"littlegreys_steer"</span></span>
<span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"pacific_lower"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"pacific_NA"</span></span>
<span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="st">"pacific_upper"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"pacific_NA"</span></span>
<span></span>
<span><span class="co"># drop reporting groups that cannot be easily combined</span></span>
<span><span class="va">all_input</span> <span class="op">&lt;-</span> <span class="va">all_input</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">repunit</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"schwabacher_NA"</span>, <span class="st">"southbuffalofork_NA"</span>, <span class="st">"jack_NA"</span>, <span class="st">"bacon_NA"</span>, <span class="st">"bear_NA"</span>, <span class="st">"sheep_NA"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_input</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">repunit</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarise</span><span class="op">(</span>ct <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">reactable</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">add_title</span><span class="op">(</span><span class="st">"Final/combined reporting unit (population) sample sizes."</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<h1 style="color:#000;background:#FFFFFF;text-align:left;font-size:32px;font-style:normal;font-weight:bold;text-decoration:;letter-spacing:px;word-spacing:px;text-transform:;text-shadow:;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px">Final/combined reporting unit (population) sample sizes.</h1>
<div class="reactable html-widget html-fill-item" id="htmlwidget-8e7f33768d99524da58a" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8e7f33768d99524da58a">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"repunit":["bailey_NA","blackrock_lower","blackrock_upper","blacktail_NA","blindbull_NA","boulder_NA","box_NA","cabin_NA","clear_NA","cliff_NA","cody_bluecrane","cottonwood_grosventre","cottonwood_nps","cowboycabin_NA","crystal_lower","crystal_upper","deadman_greys","deadmansbar_NA","dell_NA","ditch_NA","dog_NA","fall_coburn","fish_NA","fish_grosventre","flat_NA","fordspring_NA","goosewing_NA","granite_lower","granite_upper","grosventre_lower","hoback_upper","horse_NA","lava_NA","leidy_NA","littlegreys_steer","lowerbarbc_NA","mosquito_NA","northbuffalofork_NA","pacific_NA","rock_NA","shoal_NA","slate_NA","snakeriversidechannel_NA","spread_southfork","spread_uppermainstem","spreadnf_flagstaff","spring_nps","spring_tss","threechannel_NA","upperbarbc_NA","white_NA","willow_NA",null],"ct":[29,29,27,42,30,29,16,37,37,38,18,34,40,23,30,29,26,25,31,23,46,75,82,17,30,13,10,38,17,38,38,24,34,16,77,40,40,40,62,20,40,34,31,36,33,14,25,15,39,39,14,40,1511]},"columns":[{"id":"repunit","name":"repunit","type":"character"},{"id":"ct","name":"ct","type":"numeric"}],"dataKey":"a40faf8a5f476e001e6f0d6901fa1f6b"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Write out cleaned data</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">write_csv</span><span class="op">(</span><span class="va">all_input</span>, <span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/UpperSnakeRiver_GTseq_InputData_NoSibs_clean.csv"</span><span class="op">)</span></span>
<span><span class="va">all_input</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/UpperSnakeRiver_GTseq_InputData_NoSibs_clean.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="delineate-sample-type" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="delineate-sample-type">
<span class="header-section-number">3.3</span> Delineate sample type</h2>
<p>Separate reference and mixture samples</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ref_input</span> <span class="op">&lt;-</span> <span class="va">all_input</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">sample_type</span> <span class="op">==</span> <span class="st">"reference"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">mix_input</span> <span class="op">&lt;-</span> <span class="va">all_input</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">all_input</span><span class="op">$</span><span class="va">sample_type</span> <span class="op">==</span> <span class="st">"mixture"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">ref_input</span> <span class="op">&lt;-</span> <span class="va">ref_input</span> <span class="op">%&gt;%</span> <span class="fu">mutate_if</span><span class="op">(</span><span class="va">is.double</span>, <span class="va">as.integer</span><span class="op">)</span> <span class="co"># make sure everything is an interger</span></span>
<span><span class="va">mix_input</span> <span class="op">&lt;-</span> <span class="va">mix_input</span> <span class="op">%&gt;%</span> <span class="fu">mutate_if</span><span class="op">(</span><span class="va">is.double</span>, <span class="va">as.integer</span><span class="op">)</span> <span class="co"># make sure everything is an interger</span></span>
<span></span>
<span><span class="co"># view reporting units</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">ref_input</span><span class="op">$</span><span class="va">repunit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "bailey_NA"                "blackrock_lower"         
 [3] "blackrock_upper"          "blacktail_NA"            
 [5] "blindbull_NA"             "cody_bluecrane"          
 [7] "boulder_NA"               "box_NA"                  
 [9] "cabin_NA"                 "clear_NA"                
[11] "cliff_NA"                 "fall_coburn"             
[13] "cottonwood_grosventre"    "cottonwood_nps"          
[15] "cowboycabin_NA"           "crystal_lower"           
[17] "crystal_upper"            "deadmansbar_NA"          
[19] "dell_NA"                  "ditch_NA"                
[21] "dog_NA"                   "fish_grosventre"         
[23] "fish_NA"                  "spreadnf_flagstaff"      
[25] "flat_NA"                  "fordspring_NA"           
[27] "goosewing_NA"             "granite_lower"           
[29] "granite_upper"            "grosventre_lower"        
[31] "hoback_upper"             "horse_NA"                
[33] "lava_NA"                  "leidy_NA"                
[35] "littlegreys_steer"        "lowerbarbc_NA"           
[37] "mosquito_NA"              "northbuffalofork_NA"     
[39] "deadman_greys"            "pacific_NA"              
[41] "rock_NA"                  "shoal_NA"                
[43] "slate_NA"                 "snakeriversidechannel_NA"
[45] "spread_southfork"         "spread_uppermainstem"    
[47] "spring_nps"               "spring_tss"              
[49] "threechannel_NA"          "upperbarbc_NA"           
[51] "white_NA"                 "willow_NA"               </code></pre>
</div>
</div>
<p>Write out and read in reference and mixture data files</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">write_csv</span><span class="op">(</span><span class="va">ref_input</span>, <span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/UpperSnakeRiver_GTseq_InputData_NoSibs_clean_baseline.csv"</span><span class="op">)</span></span>
<span><span class="fu">write_csv</span><span class="op">(</span><span class="va">mix_input</span>, <span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/UpperSnakeRiver_GTseq_InputData_NoSibs_clean_mixture.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ref_input</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/UpperSnakeRiver_GTseq_InputData_NoSibs_clean_baseline.csv"</span><span class="op">)</span></span>
<span><span class="va">mix_input</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/UpperSnakeRiver_GTseq_InputData_NoSibs_clean_mixture.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ref_input</span> <span class="op">&lt;-</span> <span class="va">ref_input</span> <span class="op">%&gt;%</span> <span class="fu">mutate_if</span><span class="op">(</span><span class="va">is.double</span>, <span class="va">as.integer</span><span class="op">)</span> <span class="co"># make sure everything is an interger</span></span>
<span><span class="va">mix_input</span> <span class="op">&lt;-</span> <span class="va">mix_input</span> <span class="op">%&gt;%</span> <span class="fu">mutate_if</span><span class="op">(</span><span class="va">is.double</span>, <span class="va">as.integer</span><span class="op">)</span> <span class="co"># make sure everything is an interger</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="self-assignment-tests" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="self-assignment-tests">
<span class="header-section-number">3.4</span> Self-assignment tests</h2>
<section id="run-self-assignment" class="level3" data-number="3.4.1"><h3 data-number="3.4.1" class="anchored" data-anchor-id="run-self-assignment">
<span class="header-section-number">3.4.1</span> Run self-assignment</h3>
<p>Run the self-assignment tests and summarize results by individual, saving only the most likely inferred rep unit:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">self_test</span> <span class="op">&lt;-</span> <span class="fu">self_assign</span><span class="op">(</span><span class="va">ref_input</span>, <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Summary Statistics:

1710 Individuals in Sample

266 Loci: Amish_ONCB_RAD_10777, Amish_ONCB_RAD_31309, Amish_YCT_RAD_VAR_10439, Amish_YCT_RAD_VAR_524, Amish_YCT_RAD_VAR_5315, BCT_Amish_ONCB_RAD_44581, BCT_Amish_RAD_VAR_123, BCT_Amish_RAD_VAR_147, BCT_Amish_RAD_VAR_162, BCT_Amish_RAD_VAR_22888, BCT_Amish_RAD_VAR_47, Houston_Oc12653_72, Houston_Oc14458_107, Houston_Oc15873_229, Houston_Oc26415_290, Houston_Oc29335_82, Houston_Oc32144_118, Houston_Oc4332_250, Houston_Oc7137_365, IDFG_YCT_v1_Ocl10752_37, IDFG_YCT_v1_Ocl14778_68, IDFG_YCT_v1_Ocl15057_51, IDFG_YCT_v1_Ocl19676_45, IDFG_YCT_v1_Ocl22037_73, IDFG_YCT_v1_Ocl31603_69, IDFG_YCT_v1_Ocl34332_29, IDFG_YCT_v1_Ocl34660_49, IDFG_YCT_v1_Ocl36010_70, IDFG_YCT_v1_Ocl37592_62, IDFG_YCT_v1_Ocl40511_53, IDFG_YCT_v1_Ocl42695_26, IDFG_YCT_v1_Ocl46627_28, IDFG_YCT_v1_Ocl59008_57, IDFG_YCT_v1_Ocl60310_26, IDFG_YCT_v1_Ocl61681_32, IDFG_YCT_v1_Ocl63987_50, IDFG_YCT_v1_Ocl71066_31, IDFG_YCT_v1_Ocl71780_28, IDFG_YCT_v1_Ocl76788_41, IDFG_YCT_v1_Ocl77114_57, IDFG_YCT_v1_Ocl77417_51, IDFG_YCT_v1_Ocl81780_58, IDFG_YCT_v1_Ocl84360_65, IDFG_YCT_v1_Ocl84938_50, IDFG_YCT_v1_Ocl88159_69, IDFG_YCT_v1_Ocl91407_50, IDFG_YCT_v1_Ocl94063_37, IDFG_YCT_v2_Ocl11239_43, IDFG_YCT_v2_Ocl11315_52, IDFG_YCT_v2_Ocl11368_65, IDFG_YCT_v2_Ocl12924_45, IDFG_YCT_v2_Ocl13566_60, IDFG_YCT_v2_Ocl1388_66, IDFG_YCT_v2_Ocl1427_32, IDFG_YCT_v2_Ocl14551_39, IDFG_YCT_v2_Ocl16282_49, IDFG_YCT_v2_Ocl17893_44, IDFG_YCT_v2_Ocl2084_35, IDFG_YCT_v2_Ocl2146_52, IDFG_YCT_v2_Ocl21864_63, IDFG_YCT_v2_Ocl23695_55, IDFG_YCT_v2_Ocl2550_72, IDFG_YCT_v2_Ocl26454_40, IDFG_YCT_v2_Ocl265_70, IDFG_YCT_v2_Ocl27300_47, IDFG_YCT_v2_Ocl27652_74, IDFG_YCT_v2_Ocl30726_53, IDFG_YCT_v2_Ocl31182_39, IDFG_YCT_v2_Ocl32300_38, IDFG_YCT_v2_Ocl34053_56, IDFG_YCT_v2_Ocl36520_63, IDFG_YCT_v2_Ocl37211_48, IDFG_YCT_v2_Ocl38706_58, IDFG_YCT_v2_Ocl40834_41, IDFG_YCT_v2_Ocl422_41, IDFG_YCT_v2_Ocl42464_53, IDFG_YCT_v2_Ocl43873_47, IDFG_YCT_v2_Ocl44431_43, IDFG_YCT_v2_Ocl44830_68, IDFG_YCT_v2_Ocl46339_34, IDFG_YCT_v2_Ocl49447_63, IDFG_YCT_v2_Ocl49571_62, IDFG_YCT_v2_Ocl50017_60, IDFG_YCT_v2_Ocl50071_45, IDFG_YCT_v2_Ocl519_41, IDFG_YCT_v2_Ocl52778_33, IDFG_YCT_v2_Ocl54193_34, IDFG_YCT_v2_Ocl54206_70, IDFG_YCT_v2_Ocl5447_29, IDFG_YCT_v2_Ocl54533_63, IDFG_YCT_v2_Ocl55445_29, IDFG_YCT_v2_Ocl55778_72, IDFG_YCT_v2_Ocl55912_68, IDFG_YCT_v2_Ocl55949_70, IDFG_YCT_v2_Ocl56279_67, IDFG_YCT_v2_Ocl56509_52, IDFG_YCT_v2_Ocl60251_33, IDFG_YCT_v2_Ocl6060_34, IDFG_YCT_v2_Ocl60614_28, IDFG_YCT_v2_Ocl62064_52, IDFG_YCT_v2_Ocl63356_62, IDFG_YCT_v2_Ocl6421_62, IDFG_YCT_v2_Ocl64283_57, IDFG_YCT_v2_Ocl65458_43, IDFG_YCT_v2_Ocl65556_55, IDFG_YCT_v2_Ocl66566_29, IDFG_YCT_v2_Ocl67304_74, IDFG_YCT_v2_Ocl67496_54, IDFG_YCT_v2_Ocl68734_33, IDFG_YCT_v2_Ocl70919_58, IDFG_YCT_v2_Ocl72577_41, IDFG_YCT_v2_Ocl74070_69, IDFG_YCT_v2_Ocl7485_51, IDFG_YCT_v2_Ocl75459_71, IDFG_YCT_v2_Ocl76462_53, IDFG_YCT_v2_Ocl77748_54, IDFG_YCT_v2_Ocl78611_27, IDFG_YCT_v2_Ocl81521_63, IDFG_YCT_v2_Ocl82356_38, IDFG_YCT_v2_Ocl85546_44, IDFG_YCT_v2_Ocl85788_72, IDFG_YCT_v2_Ocl88352_46, IDFG_YCT_v2_Ocl89557_55, IDFG_YCT_v2_Ocl89640_61, IDFG_YCT_v2_Ocl90760_67, IDFG_YCT_v2_Ocl91717_43, IDFG_YCT_v2_Ocl92711_46, IDFG_YCT_v2_Ocl92807_65, IDFG_YCT_v2_Ocl94003_28, IDFG_YCT_v2_Ocl95170_53, IDFG_YCT_v2_Ocl9569_56, IDFG_YCT_v2_Ocl96084_64, Ocl_Chr01_11904953_886586, Ocl_Chr01_1245617_71241, Ocl_Chr01_23856908_2184084, Ocl_Chr01_4263947_240975, Ocl_Chr01_47294360_4844114, Ocl_Chr01_49304682_5059357, Ocl_Chr01_65204432_6778384, Ocl_Chr02_10093148_9366995, Ocl_Chr02_14036883_9774445, Ocl_Chr02_41111233_12592907, Ocl_Chr02_58755685_14645010, Ocl_Chr02_76311531_16531892, Ocl_Chr03_36100207_20027295, Ocl_Chr03_46187757_21021777, Ocl_Chr03_54445579_22006371, Ocl_Chr03_60635751_22668909, Ocl_Chr03_72820636_23938332, Ocl_Chr03_79199746_24455183, Ocl_Chr04_28783021_27639317, Ocl_Chr04_33023764_28088603, Ocl_Chr04_34213356_28219597, Ocl_Chr04_37222382_28545529, Ocl_Chr04_4678489_25012683, Ocl_Chr04_66392742_31700304, Ocl_Chr04_76210634_32621008, Ocl_Chr05_18555027_34575154, Ocl_Chr05_22353480_34975528, Ocl_Chr05_42479354_37280182, Ocl_Chr05_61430172_39368537, Ocl_Chr05_90410498_42131005, Ocl_Chr06_12420435_43129369, Ocl_Chr06_28577594_45059601, Ocl_Chr06_32944093_45564942, Ocl_Chr06_35552627_45862909, Ocl_Chr06_49347522_47229937, Ocl_Chr06_56703154_48022435, Ocl_Chr06_64424167_48985347, Ocl_Chr06_71071691_49699566, Ocl_Chr07_14856486_51326380, Ocl_Chr07_45996063_54719254, Ocl_Chr08_14771460_58941711, Ocl_Chr08_23127002_59937218, Ocl_Chr08_33342876_61016343, Ocl_Chr08_48135323_62498005, Ocl_Chr08_74452534_65317301, Ocl_Chr08_7913543_58216480, Ocl_Chr09_12790880_66825607, Ocl_Chr09_132589_65891972, Ocl_Chr09_14235478_66977774, Ocl_Chr09_21685484_67771579, Ocl_Chr09_39167685_69625176, Ocl_Chr09_41620059_69897246, Ocl_Chr09_48490705_70660510, Ocl_Chr09_49571462_70771512, Ocl_Chr09_55763419_71454240, Ocl_Chr10_22333094_74392487, Ocl_Chr10_32709329_75590026, Ocl_Chr10_35395407_75918540, Ocl_Chr10_53349684_77957625, Ocl_Chr10_54394964_78034790, Ocl_Chr11_18904366_80819009, Ocl_Chr11_21392774_81080130, Ocl_Chr11_35455748_82543634, Ocl_Chr11_39252193_82950896, Ocl_Chr11_54823421_84757779, Ocl_Chr11_6830863_79676696, Ocl_Chr12_30853101_89944910, Ocl_Chr13_34569062_98344570, Ocl_Chr13_35713851_98470555, Ocl_Chr14_20673116_102159336, Ocl_Chr14_62417220_105680075, Ocl_Chr14_80074953_107013785, Ocl_Chr15_19410515_108579195, Ocl_Chr15_3073223_107182434, Ocl_Chr15_39936653_110688475, Ocl_Chr16_14068105_113855290, Ocl_Chr16_19294381_114484561, Ocl_Chr16_21297075_114698152, Ocl_Chr16_5821040_113058367, Ocl_Chr16_63319498_119126301, Ocl_Chr16_65382802_119281196, Ocl_Chr17_20643875_121278476, Ocl_Chr17_26126051_121852980, Ocl_Chr17_36673466_122916670, Ocl_Chr17_46042425_123978835, Ocl_Chr17_58461865_125358635, Ocl_Chr17_7063635_119896425, Ocl_Chr17_9605415_120120519, Ocl_Chr18_26129647_129072958, Ocl_Chr18_34123442_129934400, Ocl_Chr18_35134435_130052437, Ocl_Chr18_36418251_130188244, Ocl_Chr18_38639143_130419135, Ocl_Chr18_44149294_130969040, Ocl_Chr18_45469522_131108058, Ocl_Chr19_22044194_134075134, Ocl_Chr19_28187340_134737135, Ocl_Chr19_32462945_135228332, Ocl_Chr19_33933079_135391160, Ocl_Chr19_44285651_136670064, Ocl_Chr19_58647860_137848971, Ocl_Chr20_19804435_139941027, Ocl_Chr20_31497051_141180625, Ocl_Chr20_36341695_141577269, Ocl_Chr20_38432054_141654148, Ocl_Chr20_6483466_138507676, Ocl_Chr21_45679568_145746560, Ocl_Chr21_50128962_145994829, Ocl_Chr22_8259981_146905324, Ocl_Chr23_14630597_152413591, Ocl_Chr24_16906646_157657003, Ocl_Chr24_3186803_156112670, Ocl_Chr24_39049170_159471644, Ocl_Chr25_11233782_160156892, Ocl_Chr25_24758789_161407476, Ocl_Chr25_28253023_161776112, Ocl_Chr25_44677311_163459109, Ocl_Chr25_60480751_165272387, Ocl_Chr25_69908699_166328532, Ocl_Chr26_24390262_169834458, Ocl_Chr27_16961377_172557845, Ocl_Chr27_22043133_173151182, Ocl_Chr27_26384321_173647407, Ocl_Chr28_15322293_176508570, Ocl_Chr28_30520066_178158297, Ocl_Chr28_36489115_178685376, Ocl_Chr29_14439470_180329363, Ocl_Chr29_17780195_180714945, Ocl_Chr29_20234359_180988711, Ocl_Chr29_23441334_181337945, Ocl_Chr29_38743868_182891893, Ocl_Chr29_9370320_179810673, OclYSD123205_Garza, X2017SDYCUT

52 Reporting Units: bailey_NA, blackrock_lower, blackrock_upper, blacktail_NA, blindbull_NA, cody_bluecrane, boulder_NA, box_NA, cabin_NA, clear_NA, cliff_NA, fall_coburn, cottonwood_grosventre, cottonwood_nps, cowboycabin_NA, crystal_lower, crystal_upper, deadmansbar_NA, dell_NA, ditch_NA, dog_NA, fish_grosventre, fish_NA, spreadnf_flagstaff, flat_NA, fordspring_NA, goosewing_NA, granite_lower, granite_upper, grosventre_lower, hoback_upper, horse_NA, lava_NA, leidy_NA, littlegreys_steer, lowerbarbc_NA, mosquito_NA, northbuffalofork_NA, deadman_greys, pacific_NA, rock_NA, shoal_NA, slate_NA, snakeriversidechannel_NA, spread_southfork, spread_uppermainstem, spring_nps, spring_tss, threechannel_NA, upperbarbc_NA, white_NA, willow_NA

63 Collections: bailey_NA, blackrock_lower, blackrock_upper, blacktail_NA, blindbull_NA, bluecrane_ford, boulder_NA, box_NA, cabin_NA, clear_NA, cliff_NA, coburn_NA, cody_moment, cottonwood_grosventre, cottonwood_nps, cowboycabin_NA, cowboycabin_springchannels, crystal_lower, crystal_upper, deadmansbar_NA, dell_NA, ditch_NA, dog_NA, fall_lower, fall_upper, fish_grosventre, fish_lower, fish_upper, flagstaff_NA, flat_NA, fordspring_NA, goosewing_NA, granite_lower, granite_upper, grosventre_lower, hoback_upper, horse_NA, lava_NA, leidy_NA, littlegreys_lower, littlegreys_upper, lowerbarbc_NA, mosquito_NA, northbuffalofork_NA, deadman_greys, pacific_lower, pacific_upper, rock_NA, shoal_NA, slate_lower, slate_upper, snakeriversidechannel_NA, spread_northfork, spread_southfork, spread_uppermainstem, spring_nps, spring_tss, steer_NA, threechannel_eastfork, threechannel_westfork, upperbarbc_NA, white_NA, willow_NA

6.25% of allelic data identified as missing</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">self_test_exam</span> <span class="op">&lt;-</span> <span class="va">self_test</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">indiv</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">top_n</span><span class="op">(</span><span class="fl">1</span>, <span class="va">log_likelihood</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="inspect-z-scores" class="level3" data-number="3.4.2"><h3 data-number="3.4.2" class="anchored" data-anchor-id="inspect-z-scores">
<span class="header-section-number">3.4.2</span> Inspect z-scores</h3>
<p>Z-scores provide an indication of the likelihood that an individual belongs to a reporting group other than that to which it was assigned. Because we are performing self-assignment tests, we would not expect to see any major outliers.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">self_test_exam</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">repunit</span>, y <span class="op">=</span> <span class="va">z_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="BaselineDataTesting_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="864"></p>
<figcaption>Distribution of z-scores by population</figcaption></figure>
</div>
</div>
</div>
</section><section id="self-assignment-likelihood" class="level3" data-number="3.4.3"><h3 data-number="3.4.3" class="anchored" data-anchor-id="self-assignment-likelihood">
<span class="header-section-number">3.4.3</span> Self-assignment likelihood</h3>
<p>Do individuals generally assign to their source reporting unit with high assignment likelihood? Expectation is the mean/median should be near 1, anything much lower would be cause for concern.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Distribution of assignment likelihood</span></span>
<span><span class="co">#| fig-cap: "Distribution of indvidual assignment likelihoods."</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">self_test_exam</span><span class="op">$</span><span class="va">scaled_likelihood</span><span class="op">)</span> <span class="co"># probability of assignment to a single reporting group is very high for nearly all individuals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="BaselineDataTesting_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p1</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Mean = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">self_test_exam</span><span class="op">$</span><span class="va">scaled_likelihood</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="st">"; Median = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">self_test_exam</span><span class="op">$</span><span class="va">scaled_likelihood</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="BaselineDataTesting_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section><section id="accuracy-and-efficiency" class="level3" data-number="3.4.4"><h3 data-number="3.4.4" class="anchored" data-anchor-id="accuracy-and-efficiency">
<span class="header-section-number">3.4.4</span> Accuracy and efficiency</h3>
<p>Inspect self-assignment accuracy and efficiency by reporting group.</p>
<ul>
<li>
<em>Efficiency:</em> the number of individuals known to belong to a reporting group which were recovered from the mixture.</li>
<li>
<em>Accuracy:</em> the proportion of individuals correctly assigned to a reporting group</li>
</ul>
<p>First, summarize results by reporting group:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># summarize results by reporting group</span></span>
<span><span class="va">ref_pops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">self_test_exam</span><span class="op">$</span><span class="va">repunit</span><span class="op">)</span></span>
<span><span class="va">prop_assigned_acc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ref_pops</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prop_assigned_eff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ref_pops</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sampsize</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ref_pops</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">selfassprop</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span><span class="va">ref_pops</span>, <span class="va">prop_assigned_acc</span>, <span class="va">prop_assigned_eff</span>, <span class="va">sampsize</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">selfassprop</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">corass</span> <span class="op">&lt;-</span> <span class="va">self_test_exam</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">self_test_exam</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="va">ref_pops</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span> <span class="co"># fish known to be from a given reporting unit</span></span>
<span>  <span class="va">totass</span> <span class="op">&lt;-</span> <span class="va">self_test_exam</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">self_test_exam</span><span class="op">$</span><span class="va">inferred_repunit</span> <span class="op">==</span> <span class="va">ref_pops</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span> <span class="co"># fish assigned to a given reporting unit</span></span>
<span>  <span class="va">selfassprop</span><span class="op">$</span><span class="va">prop_assigned_eff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">corass</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="va">corass</span><span class="op">$</span><span class="va">inferred_repunit</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">corass</span><span class="op">)</span> <span class="co"># Efficiency - the number of individuals known to belong to a reporting group which were recovered from the mixture</span></span>
<span>  <span class="va">selfassprop</span><span class="op">$</span><span class="va">prop_assigned_acc</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">totass</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="va">totass</span><span class="op">$</span><span class="va">inferred_repunit</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">totass</span><span class="op">)</span> <span class="co"># Accuracy - the proportion of individuals correctly assigned to a reporting group</span></span>
<span>  <span class="va">selfassprop</span><span class="op">$</span><span class="va">sampsize</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">corass</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># add coordinates for sorting</span></span>
<span><span class="va">selfassprop</span> <span class="op">&lt;-</span> <span class="va">selfassprop</span> <span class="op">%&gt;%</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">gps</span>, by <span class="op">=</span> <span class="fu">join_by</span><span class="op">(</span><span class="va">ref_pops</span> <span class="op">==</span> <span class="va">repunit</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Self-assignment efficiency, weighted mean:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html">weighted.mean</a></span><span class="op">(</span><span class="va">selfassprop</span><span class="op">$</span><span class="va">prop_assigned_eff</span>, <span class="va">selfassprop</span><span class="op">$</span><span class="va">sampsize</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">selfassprop</span><span class="op">$</span><span class="va">sampsize</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8239766</code></pre>
</div>
</div>
<p>Self-assignment accuracy, weighted mean:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html">weighted.mean</a></span><span class="op">(</span><span class="va">selfassprop</span><span class="op">$</span><span class="va">prop_assigned_acc</span>, <span class="va">selfassprop</span><span class="op">$</span><span class="va">sampsize</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">selfassprop</span><span class="op">$</span><span class="va">sampsize</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8387791</code></pre>
</div>
</div>
<p>How does reporting group accuracy and efficiency scale with sample size? Generally positively, but relationships with sample size are weak. I.e., even reporting groups with small sample sizes have relatively high accuracy/efficiency and thus low acc/eff are likely not a function of sample size.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2.5</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">prop_assigned_eff</span> <span class="op">~</span> <span class="va">sampsize</span>, <span class="va">selfassprop</span>, xlab <span class="op">=</span> <span class="st">"Sample Size"</span>, ylab <span class="op">=</span> <span class="st">"Self-Assignment Efficiency"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Weighted Mean Eff. = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html">weighted.mean</a></span><span class="op">(</span><span class="va">selfassprop</span><span class="op">$</span><span class="va">prop_assigned_eff</span>, <span class="va">selfassprop</span><span class="op">$</span><span class="va">sampsize</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">selfassprop</span><span class="op">$</span><span class="va">sampsize</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">prop_assigned_acc</span> <span class="op">~</span> <span class="va">sampsize</span>, <span class="va">selfassprop</span>, xlab <span class="op">=</span> <span class="st">"Sample Size"</span>, ylab <span class="op">=</span> <span class="st">"Self-Assignment Accuracy"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Weighted Mean Acc. = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html">weighted.mean</a></span><span class="op">(</span><span class="va">selfassprop</span><span class="op">$</span><span class="va">prop_assigned_acc</span>, <span class="va">selfassprop</span><span class="op">$</span><span class="va">sampsize</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">selfassprop</span><span class="op">$</span><span class="va">sampsize</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="BaselineDataTesting_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>View accuracy and efficiency by reporting group:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">selfassprop_gather</span> <span class="op">&lt;-</span> <span class="va">selfassprop</span> <span class="op">%&gt;%</span> <span class="fu">gather</span><span class="op">(</span><span class="va">type</span>, <span class="va">value</span>, <span class="va">prop_assigned_acc</span><span class="op">:</span><span class="va">prop_assigned_eff</span><span class="op">)</span></span>
<span><span class="va">selfassprop_gather</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">ref_pops</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Reporting Group"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Accuracy or Efficiency"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_fill_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">""</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Accuracy"</span>, <span class="st">"Efficiency"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="BaselineDataTesting_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<p>Reproduce the plot above, but only show accuracy and use numbered reporting groups, by latitude (for supplementary materials).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">selfassprop</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">ref_pops</span>, <span class="op">-</span><span class="va">lat</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">prop_assigned_acc</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Reporting unit"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Self-assignment accuracy"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_x_discrete</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">52</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="BaselineDataTesting_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<p>Write-out self-assignment test results</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">write_csv</span><span class="op">(</span><span class="va">self_test_exam</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span>, file <span class="op">=</span> <span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Self Assignment/self_assign_results_individuals.csv"</span><span class="op">)</span></span>
<span><span class="fu">write_csv</span><span class="op">(</span><span class="va">selfassprop</span>, file <span class="op">=</span> <span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Self Assignment/self_assign_results_repgroups.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="confusion-matrix" class="level3" data-number="3.4.5"><h3 data-number="3.4.5" class="anchored" data-anchor-id="confusion-matrix">
<span class="header-section-number">3.4.5</span> Confusion matrix</h3>
<p>Construct self-assignment confusion matrix: to which reporting units are individuals of known-origin being (mistakenly) assigned?</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">conf_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">self_test_exam</span><span class="op">$</span><span class="va">repunit</span><span class="op">)</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">self_test_exam</span><span class="op">$</span><span class="va">repunit</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">conf_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">selfassprop</span><span class="op">$</span><span class="va">ref_pops</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">conf_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">selfassprop</span><span class="op">$</span><span class="va">ref_pops</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">conf_mat</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">conf_mat</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">conf_mat</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">self_test_exam</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">conf_mat</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">self_test_exam</span><span class="op">$</span><span class="va">inferred_repunit</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">conf_mat</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">self_test_exam</span><span class="op">$</span><span class="va">repunit</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">conf_mat</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># check confusion matrix -- all rows should add to 1</span></span>
<span><span class="co"># check &lt;- apply(conf_mat, 1, sum)</span></span>
<span><span class="co"># table(check == 1)</span></span>
<span><span class="fu">reactable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">conf_mat</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-fe72a6079051b7adc50b" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-fe72a6079051b7adc50b">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".rownames":["bailey_NA","blackrock_lower","blackrock_upper","blacktail_NA","blindbull_NA","cody_bluecrane","boulder_NA","box_NA","cabin_NA","clear_NA","cliff_NA","fall_coburn","cottonwood_grosventre","cottonwood_nps","cowboycabin_NA","crystal_lower","crystal_upper","deadmansbar_NA","dell_NA","ditch_NA","dog_NA","fish_grosventre","fish_NA","spreadnf_flagstaff","flat_NA","fordspring_NA","goosewing_NA","granite_lower","granite_upper","grosventre_lower","hoback_upper","horse_NA","lava_NA","leidy_NA","littlegreys_steer","lowerbarbc_NA","mosquito_NA","northbuffalofork_NA","deadman_greys","pacific_NA","rock_NA","shoal_NA","slate_NA","snakeriversidechannel_NA","spread_southfork","spread_uppermainstem","spring_nps","spring_tss","threechannel_NA","upperbarbc_NA","white_NA","willow_NA"],"bailey_NA":[0.483,0,0,0,0,0,0,0,0.027,0,0,0,0,0,0,0,0,0,0.032,0,0.022,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.05],"blackrock_lower":[0,0.862,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.071,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"blackrock_upper":[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"blacktail_NA":[0,0,0,0.786,0,0,0,0,0,0,0,0,0,0.025,0.304,0,0,0.04,0,0,0,0,0.012,0,0,0,0,0,0,0.053,0,0,0,0,0,0,0,0.025,0,0.016,0,0,0,0.161,0,0,0,0,0,0.179,0,0],"blindbull_NA":[0,0,0,0,0.767,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.077,0,0,0,0,0,0,0,0,0,0,0,0.214,0],"cody_bluecrane":[0,0,0,0,0,0.889,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"boulder_NA":[0,0,0,0,0,0,0.828,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.132,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.025],"box_NA":[0,0,0,0,0,0,0,0.688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"cabin_NA":[0.034,0,0,0,0,0,0,0,0.838,0,0,0,0,0,0,0,0,0,0,0,0.065,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.077,0,0,0,0,0,0,0,0,0,0,0,0,0.025],"clear_NA":[0,0,0,0,0,0,0,0.188,0,0.865,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"cliff_NA":[0.034,0,0,0,0,0,0,0,0,0,0.895,0,0,0,0,0,0,0,0.032,0,0.022,0,0,0,0,0,0,0,0.118,0,0,0.042,0,0,0,0,0,0,0,0,0,0.05,0,0,0,0,0,0,0,0,0,0],"fall_coburn":[0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"cottonwood_grosventre":[0,0,0,0,0,0,0,0,0,0,0,0,0.971,0,0,0,0,0,0,0,0,0.118,0,0,0,0,0.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"cottonwood_nps":[0.103,0,0,0.048,0,0,0,0,0,0,0,0,0,0.975,0,0,0,0,0,0,0,0,0,0,0.033,0.154,0,0,0,0,0,0,0,0,0,0,0,0,0,0.016,0,0,0,0,0,0,0,0,0,0,0.071,0],"cowboycabin_NA":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.391,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.065,0,0,0,0,0,0.051,0,0],"crystal_lower":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.833,0.034,0,0,0,0,0.059,0,0,0,0,0.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.071,0],"crystal_upper":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.167,0.897,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"deadmansbar_NA":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.043,0,0,0.84,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"dell_NA":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.806,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"ditch_NA":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"dog_NA":[0.069,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.891,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"fish_grosventre":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.034,0,0,0,0,0.647,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"fish_NA":[0.138,0,0,0,0,0.056,0,0.125,0,0.027,0,0,0,0,0,0,0.034,0,0,0,0,0,0.805,0,0.033,0.154,0,0,0,0.026,0,0,0,0,0,0.1,0.075,0.15,0,0.016,0,0,0,0,0,0,0,0,0.051,0,0,0.05],"spreadnf_flagstaff":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.571,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.03,0,0,0,0,0,0],"flat_NA":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.833,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"fordspring_NA":[0,0,0,0,0,0.056,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.462,0,0,0,0,0,0,0,0,0,0.025,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"goosewing_NA":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.059,0,0,0,0,0.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"granite_lower":[0,0,0,0,0,0,0.138,0,0,0,0.026,0,0,0,0,0,0,0,0.032,0,0,0,0,0,0,0,0,0.842,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"granite_upper":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.706,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"grosventre_lower":[0,0.034,0,0,0,0,0,0,0,0,0,0,0,0,0.043,0,0,0,0,0,0,0.059,0.037,0,0,0.077,0.2,0,0,0.842,0.026,0,0,0,0,0.05,0.025,0,0,0.032,0,0,0.059,0,0,0,0,0,0.154,0,0,0.025],"hoback_upper":[0,0,0,0,0,0,0.034,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.012,0,0,0,0,0,0.059,0,0.895,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.026,0,0,0],"horse_NA":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.917,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"lava_NA":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.971,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"leidy_NA":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"littlegreys_steer":[0,0,0,0,0.067,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0.077,0,0,0,0,0,0,0,0,0,0,0,0.071,0],"lowerbarbc_NA":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.032,0,0,0,0.061,0,0.067,0,0,0,0,0.026,0.026,0,0,0,0,0.675,0,0,0,0.016,0,0,0.029,0.032,0,0,0,0,0.179,0,0,0],"mosquito_NA":[0,0,0,0.024,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.032,0,0,0,0,0,0,0,0,0,0,0.026,0,0,0,0,0,0,0.8,0,0,0.016,0,0,0,0,0,0,0,0,0,0,0,0.025],"northbuffalofork_NA":[0,0.069,0,0,0,0,0,0,0,0.108,0,0,0,0,0,0,0,0,0,0,0,0,0.012,0,0,0.077,0,0,0,0,0,0,0,0,0,0,0,0.775,0,0.016,0,0.025,0,0,0.028,0.091,0,0.133,0,0,0,0],"deadman_greys":[0,0,0,0,0.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.731,0,0,0,0,0,0,0,0,0,0,0,0,0],"pacific_NA":[0,0.034,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.071,0,0,0,0,0,0,0,0,0.029,0,0,0,0.025,0,0,0.823,0,0,0,0,0,0,0.04,0,0.026,0,0,0],"rock_NA":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],"shoal_NA":[0,0,0,0,0.033,0,0,0,0,0,0.053,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.053,0,0,0,0,0,0,0,0,0,0,0.875,0,0,0,0,0,0,0,0,0,0.1],"slate_NA":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.912,0,0,0,0,0,0,0,0,0],"snakeriversidechannel_NA":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.087,0,0,0.08,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.025,0,0,0,0,0,0,0,0.581,0,0,0,0,0.026,0.077,0,0],"spread_southfork":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.071,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.016,0,0,0,0,0.944,0.061,0,0,0,0,0,0],"spread_uppermainstem":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.059,0.012,0.143,0,0,0,0,0,0,0,0,0,0,0,0,0.025,0,0,0,0,0,0,0,0.028,0.818,0,0,0,0,0,0],"spring_nps":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.071,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.96,0,0,0,0,0],"spring_tss":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.867,0,0,0,0],"threechannel_NA":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.077,0,0,0,0,0,0,0,0,0,0.125,0.025,0.025,0,0.016,0,0,0,0.032,0,0,0,0,0.513,0,0,0],"upperbarbc_NA":[0,0,0,0.143,0,0,0,0,0,0,0,0,0,0,0.13,0,0,0.04,0,0,0,0,0,0,0.033,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.016,0,0,0,0.129,0,0,0,0,0,0.667,0,0],"white_NA":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0],"willow_NA":[0.138,0,0,0,0.033,0,0,0,0.135,0,0.026,0,0.029,0,0,0,0,0,0.032,0,0,0,0.049,0,0,0,0,0.026,0.118,0.026,0,0.042,0,0,0,0,0.025,0.025,0.038,0,0,0.05,0,0,0,0,0,0,0.026,0.026,0.071,0.7]},"columns":[{"id":".rownames","name":"","type":"character","sortable":false,"filterable":false,"rowHeader":true},{"id":"bailey_NA","name":"bailey_NA","type":"numeric"},{"id":"blackrock_lower","name":"blackrock_lower","type":"numeric"},{"id":"blackrock_upper","name":"blackrock_upper","type":"numeric"},{"id":"blacktail_NA","name":"blacktail_NA","type":"numeric"},{"id":"blindbull_NA","name":"blindbull_NA","type":"numeric"},{"id":"cody_bluecrane","name":"cody_bluecrane","type":"numeric"},{"id":"boulder_NA","name":"boulder_NA","type":"numeric"},{"id":"box_NA","name":"box_NA","type":"numeric"},{"id":"cabin_NA","name":"cabin_NA","type":"numeric"},{"id":"clear_NA","name":"clear_NA","type":"numeric"},{"id":"cliff_NA","name":"cliff_NA","type":"numeric"},{"id":"fall_coburn","name":"fall_coburn","type":"numeric"},{"id":"cottonwood_grosventre","name":"cottonwood_grosventre","type":"numeric"},{"id":"cottonwood_nps","name":"cottonwood_nps","type":"numeric"},{"id":"cowboycabin_NA","name":"cowboycabin_NA","type":"numeric"},{"id":"crystal_lower","name":"crystal_lower","type":"numeric"},{"id":"crystal_upper","name":"crystal_upper","type":"numeric"},{"id":"deadmansbar_NA","name":"deadmansbar_NA","type":"numeric"},{"id":"dell_NA","name":"dell_NA","type":"numeric"},{"id":"ditch_NA","name":"ditch_NA","type":"numeric"},{"id":"dog_NA","name":"dog_NA","type":"numeric"},{"id":"fish_grosventre","name":"fish_grosventre","type":"numeric"},{"id":"fish_NA","name":"fish_NA","type":"numeric"},{"id":"spreadnf_flagstaff","name":"spreadnf_flagstaff","type":"numeric"},{"id":"flat_NA","name":"flat_NA","type":"numeric"},{"id":"fordspring_NA","name":"fordspring_NA","type":"numeric"},{"id":"goosewing_NA","name":"goosewing_NA","type":"numeric"},{"id":"granite_lower","name":"granite_lower","type":"numeric"},{"id":"granite_upper","name":"granite_upper","type":"numeric"},{"id":"grosventre_lower","name":"grosventre_lower","type":"numeric"},{"id":"hoback_upper","name":"hoback_upper","type":"numeric"},{"id":"horse_NA","name":"horse_NA","type":"numeric"},{"id":"lava_NA","name":"lava_NA","type":"numeric"},{"id":"leidy_NA","name":"leidy_NA","type":"numeric"},{"id":"littlegreys_steer","name":"littlegreys_steer","type":"numeric"},{"id":"lowerbarbc_NA","name":"lowerbarbc_NA","type":"numeric"},{"id":"mosquito_NA","name":"mosquito_NA","type":"numeric"},{"id":"northbuffalofork_NA","name":"northbuffalofork_NA","type":"numeric"},{"id":"deadman_greys","name":"deadman_greys","type":"numeric"},{"id":"pacific_NA","name":"pacific_NA","type":"numeric"},{"id":"rock_NA","name":"rock_NA","type":"numeric"},{"id":"shoal_NA","name":"shoal_NA","type":"numeric"},{"id":"slate_NA","name":"slate_NA","type":"numeric"},{"id":"snakeriversidechannel_NA","name":"snakeriversidechannel_NA","type":"numeric"},{"id":"spread_southfork","name":"spread_southfork","type":"numeric"},{"id":"spread_uppermainstem","name":"spread_uppermainstem","type":"numeric"},{"id":"spring_nps","name":"spring_nps","type":"numeric"},{"id":"spring_tss","name":"spring_tss","type":"numeric"},{"id":"threechannel_NA","name":"threechannel_NA","type":"numeric"},{"id":"upperbarbc_NA","name":"upperbarbc_NA","type":"numeric"},{"id":"white_NA","name":"white_NA","type":"numeric"},{"id":"willow_NA","name":"willow_NA","type":"numeric"}],"dataKey":"33afd590bc4c0702add4911c75918582"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Write out confusion matrix</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">conf_mat</span>, file <span class="op">=</span> <span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Self Assignment/self_assign_confusion_matrix.csv"</span>, row.names <span class="op">=</span> <span class="cn">T</span>, quote <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="simulated-mixtures" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="simulated-mixtures">
<span class="header-section-number">3.5</span> Simulated mixtures</h2>
<p>Evaluate accuracy given our set of SNP markers and the grouping of collections into reporting groups</p>
<section id="run-simulations" class="level3" data-number="3.5.1"><h3 data-number="3.5.1" class="anchored" data-anchor-id="run-simulations">
<span class="header-section-number">3.5.1</span> Run simulations</h3>
<p>First, simulate mixtures and assign to reporting groups</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># usr_sims &lt;- assess_reference_loo(reference = ref_input, gen_start_col = 5, reps = 500, mixsize = 1000, return_indiv_posteriors = TRUE)</span></span>
<span><span class="co"># write_rds(usr_sims, "/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Simulated Mixtures/sim_mix.rds")</span></span>
<span><span class="va">usr_sims</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Simulated Mixtures/sim_mix.rds"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Number of simulations</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">usr_sims</span><span class="op">$</span><span class="va">mixing_proportions</span><span class="op">$</span><span class="va">iter</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 500</code></pre>
</div>
</div>
</section><section id="global-results" class="level3" data-number="3.5.2"><h3 data-number="3.5.2" class="anchored" data-anchor-id="global-results">
<span class="header-section-number">3.5.2</span> Global results</h3>
<p>Mean squared error:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">usr_sims</span><span class="op">$</span><span class="va">mixing_proportions</span><span class="op">$</span><span class="va">post_mean_pi</span> <span class="op">-</span> <span class="va">usr_sims</span><span class="op">$</span><span class="va">mixing_proportions</span><span class="op">$</span><span class="va">true_pi</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">usr_sims</span><span class="op">$</span><span class="va">mixing_proportions</span><span class="op">$</span><span class="va">iter</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003963695</code></pre>
</div>
</div>
<p>Mean residual:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">usr_sims</span><span class="op">$</span><span class="va">mixing_proportions</span><span class="op">$</span><span class="va">post_mean_pi</span> <span class="op">-</span> <span class="va">usr_sims</span><span class="op">$</span><span class="va">mixing_proportions</span><span class="op">$</span><span class="va">true_pi</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">usr_sims</span><span class="op">$</span><span class="va">mixing_proportions</span><span class="op">$</span><span class="va">iter</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1.401172e-17</code></pre>
</div>
</div>
<p>Plot estimated proportional contribution against true contribution for all simulations and populations</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">post_mean_pi</span> <span class="op">~</span> <span class="va">true_pi</span>, <span class="va">usr_sims</span><span class="op">$</span><span class="va">mixing_proportions</span>, xlab <span class="op">=</span> <span class="st">"True Mixing Proportion"</span>, ylab <span class="op">=</span> <span class="st">"Posterior Mean Mixing Proportion"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"MSE = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">usr_sims</span><span class="op">$</span><span class="va">mixing_proportions</span><span class="op">$</span><span class="va">post_mean_pi</span> <span class="op">-</span> <span class="va">usr_sims</span><span class="op">$</span><span class="va">mixing_proportions</span><span class="op">$</span><span class="va">true_pi</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">usr_sims</span><span class="op">$</span><span class="va">mixing_proportions</span><span class="op">$</span><span class="va">iter</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="BaselineDataTesting_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section><section id="by-reporting-group" class="level3" data-number="3.5.3"><h3 data-number="3.5.3" class="anchored" data-anchor-id="by-reporting-group">
<span class="header-section-number">3.5.3</span> By reporting group</h3>
<p>Summarize by reporting group and write to file</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp0</span> <span class="op">&lt;-</span> <span class="va">usr_sims</span><span class="op">$</span><span class="va">mixing_proportions</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">repunit</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span>mse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">post_mean_pi</span> <span class="op">-</span> <span class="va">true_pi</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">iter</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            mr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">post_mean_pi</span> <span class="op">-</span> <span class="va">true_pi</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">iter</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            mr.sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">post_mean_pi</span> <span class="op">-</span> <span class="va">true_pi</span><span class="op">)</span>,</span>
<span>            mr.025 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">post_mean_pi</span> <span class="op">-</span> <span class="va">true_pi</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>            mr.975 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">post_mean_pi</span> <span class="op">-</span> <span class="va">true_pi</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">tmp0</span> <span class="op">&lt;-</span> <span class="va">tmp0</span> <span class="op">%&gt;%</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">gps</span><span class="op">)</span> </span>
<span><span class="fu">write_csv</span><span class="op">(</span><span class="va">tmp0</span>, <span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Simulated Mixtures/sim_mix_repgroup_msemr.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Mean square error by reporting group</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp0</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">repunit</span>, y <span class="op">=</span> <span class="va">mse</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"grey70"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Reporting Group"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Mean square error"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="BaselineDataTesting_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<p>Mean residual by reporting group</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp0</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">repunit</span>, y <span class="op">=</span> <span class="va">mr</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"grey70"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Reporting Group"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Mean residual"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="BaselineDataTesting_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<p>Mean residual by reporting group (same as above), but numbered reporting groups with standard deviations</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp0</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">repunit</span>, <span class="op">-</span><span class="va">lat</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">mr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"grey70"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Reporting unit"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Mean residual"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_discrete</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">52</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">mr</span> <span class="op">-</span> <span class="va">mr.sd</span>, ymax <span class="op">=</span> <span class="va">mr</span> <span class="op">+</span> <span class="va">mr.sd</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="BaselineDataTesting_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<p>Plot estimated proportional contribution against true contribution for simulated mixtures for each reporting group:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">usr_sims</span><span class="op">$</span><span class="va">mixing_proportions</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">iter</span>, <span class="va">repunit</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>true_repprop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">true_pi</span><span class="op">)</span>, </span>
<span>            reprop_posterior_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">post_mean_pi</span><span class="op">)</span>,</span>
<span>            repu_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>repu_n_prop <span class="op">=</span> <span class="va">repu_n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">repu_n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">tmp</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">true_repprop</span>, y <span class="op">=</span> <span class="va">reprop_posterior_mean</span>, colour <span class="op">=</span> <span class="va">repunit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"True Mixing Proportion"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Posterior Mean Mixing Proportion"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap_paginate</span><span class="op">(</span><span class="op">~</span> <span class="va">repunit</span>, nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>colour <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># pdf("Baseline Data and Testing/Simulated Mixtures/sim_mix_repgroup_scatter.pdf", width = 8, height = 8)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">n_pages</span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p</span> <span class="op">+</span> <span class="fu">facet_wrap_paginate</span><span class="op">(</span><span class="op">~</span> <span class="va">repunit</span>, nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">4</span>, page <span class="op">=</span> <span class="va">i</span><span class="op">)</span><span class="op">)</span> <span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="BaselineDataTesting_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="BaselineDataTesting_files/figure-html/unnamed-chunk-44-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="BaselineDataTesting_files/figure-html/unnamed-chunk-44-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="BaselineDataTesting_files/figure-html/unnamed-chunk-44-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="z-scores" class="level3" data-number="3.5.4"><h3 data-number="3.5.4" class="anchored" data-anchor-id="z-scores">
<span class="header-section-number">3.5.4</span> Z-scores</h3>
<p>Can we true the posteriors from individual fish? Plot distributions of z-scores by reporting group, over all simulations</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># first summarize by reporting unit</span></span>
<span><span class="va">repu_pofzs</span> <span class="op">&lt;-</span> <span class="va">usr_sims</span><span class="op">$</span><span class="va">indiv_posteriors</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">repunit</span> <span class="op">==</span> <span class="va">simulated_repunit</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">iter</span>, <span class="va">indiv</span>, <span class="va">simulated_repunit</span>, <span class="va">repunit</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># first aggregate over reporting units</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>repu_PofZ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">PofZ</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">repunit</span>, <span class="va">simulated_repunit</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>simulated_repunit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">simulated_repunit</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">simulated_repunit</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># also get the number of simulated individuals from each collection</span></span>
<span><span class="va">num_simmed</span> <span class="op">&lt;-</span> <span class="va">usr_sims</span><span class="op">$</span><span class="va">indiv_posteriors</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">iter</span>, <span class="va">indiv</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">simulated_repunit</span><span class="op">)</span></span>
<span><span class="co"># now, plot it</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">repu_pofzs</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">simulated_repunit</span>, y <span class="op">=</span> <span class="va">repu_PofZ</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="va">repunit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span>data <span class="op">=</span> <span class="va">num_simmed</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fl">1.025</span>, label <span class="op">=</span> <span class="va">n</span><span class="op">)</span>, angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">0</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">9</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylim</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>colour <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="BaselineDataTesting_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="simulations" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="simulations">
<span class="header-section-number">3.6</span> 100% Simulations</h2>
<p>As noted elsewhere, 100% simulations are used less frequently than in the past as assumptions are unrealistic (i.e., assume mixtures only made up of individuals from a single reporting group). However, we perform them here as they provide another diagnostic tool to assess the performance of our baseline.</p>
<p>Run the simulations and write output to file. 20 simulations per reporting group.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># # create list specifying 100% mixtures</span></span>
<span><span class="co"># hundy_scenarios &lt;- lapply(unique(all_input$repunit)[!is.na(unique(all_input$repunit))], function(x) tibble(repunit = x, ppn = 1.0))</span></span>
<span><span class="co"># names(hundy_scenarios) &lt;- paste("All", unique(all_input$repunit)[!is.na(unique(all_input$repunit))], sep = "-")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # run the 100% simulations</span></span>
<span><span class="co"># repu_hundy_results &lt;- assess_reference_loo(reference = ref_input, gen_start_col = 5, reps = 20, mixsize = 500, alpha_repunit = hundy_scenarios)</span></span>
<span><span class="co"># repu_hundy_results &lt;- repu_hundy_results %&gt;% mutate(repunit_true = substr(repunit_scenario, 5, 30))</span></span>
<span><span class="co"># repu_hundy_results_sum &lt;- repu_hundy_results %&gt;% filter(repunit_true == repunit) %&gt;% group_by(iter, repunit, repunit_true) %&gt;% summarize(post_ppn = sum(post_mean_pi))</span></span>
<span><span class="co"># repu_hundy_results_sum2 &lt;- repu_hundy_results_sum %&gt;% group_by(repunit_true) %&gt;% summarize(post_ppn_mean = mean(post_ppn), post_ppn_sd = sd(post_ppn))</span></span>
<span><span class="co"># mean(repu_hundy_results_sum2$post_ppn_mean)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># write_csv(repu_hundy_results, "/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Hundred Perc Sims/sim_mix_100perc_results_raw.csv")</span></span>
<span><span class="co"># write_csv(repu_hundy_results_sum2, "/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Hundred Perc Sims/sim_mix_100perc_results_summarized.csv")</span></span>
<span></span>
<span><span class="va">repu_hundy_results_sum2</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Hundred Perc Sims/sim_mix_100perc_results_summarized.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot the results (mean and standard deviation per reporting group). Should be near 100%.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">repu_hundy_results_sum2</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">repunit_true</span>, y <span class="op">=</span> <span class="va">post_ppn_mean</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"grey70"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">repunit_true</span>, ymin <span class="op">=</span> <span class="va">post_ppn_mean</span> <span class="op">-</span> <span class="va">post_ppn_sd</span>, ymax <span class="op">=</span> <span class="va">post_ppn_mean</span> <span class="op">+</span> <span class="va">post_ppn_sd</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.4</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Reporting Group"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"100% Simulation Mixture Proportion"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="BaselineDataTesting_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../Baseline Relatedness/BaselineRelatedness.html" class="pagination-link" aria-label="Baseline Relatedness">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Baseline Relatedness</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Baseline Fst/BaselineFst.html" class="pagination-link" aria-label="Baseline Fst">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Baseline Fst</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb47" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Baseline Testing</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>Purpose: test baseline reporting groups for accuracy and efficiency using 100% simulations, self-assignment tests, and simulated mixtures. up</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="in">library(rubias)</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="in">library(knitr)</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggforce)</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="in">library(reactable)</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="in">library(reactablefmtr)</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>Load raw genotype data, sibling IDs to drop (full siblings), and gps locations (to sort)</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/usr_gsi_gtseq_plusmeta.csv"</span>)</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>drop_sibs <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Relatedness/UpperSnakeRiver_GTseq_Baseline_DropFullSiblings.csv"</span>)</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>gps <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Landscape Covariates/RepUnit_LatLong.csv"</span>)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>gps_sp <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(gps, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lon"</span>, <span class="st">"lat"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>mapview<span class="sc">::</span><span class="fu">mapview</span>(gps_sp, <span class="at">col.regions =</span> <span class="st">"blue"</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="fu">### Format data</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>gt_mat <span class="ot">&lt;-</span> data[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)] <span class="co"># pull out sequence data</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>gt_mat[gt_mat <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co"># change the missing data to NA</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a><span class="co"># ID rows corresponding to baseline vs mixture samples</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>ref_indv <span class="ot">&lt;-</span> <span class="fu">which</span>(data<span class="sc">$</span>Category <span class="sc">==</span> <span class="st">"baseline"</span>) </span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>mix_indv <span class="ot">&lt;-</span> <span class="fu">which</span>(data<span class="sc">$</span>Category <span class="sc">==</span> <span class="st">"mixture"</span>) </span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a><span class="co"># create data for sample_type column </span></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>sample_type <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"reference"</span>, <span class="fu">nrow</span>(data))</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>sample_type[mix_indv] <span class="ot">&lt;-</span> <span class="st">"mixture"</span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a><span class="co"># create data for reporting unit column</span></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>repunit <span class="ot">&lt;-</span> data<span class="sc">$</span>Pop</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>repunit[mix_indv] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a><span class="co"># create data for collection column (same as reporting unit, except for mixture samples)</span></span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>collection <span class="ot">&lt;-</span> data<span class="sc">$</span>Pop</span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a><span class="co"># IDFG EFGL sample ID</span></span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>indiv <span class="ot">&lt;-</span> data<span class="sc">$</span>SampNumber</span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a><span class="co"># combine into singe data frame</span></span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>input_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(sample_type, repunit, collection, indiv)</span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>all_input <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(input_data, gt_mat)</span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a><span class="co"># ensure that baseline individuals that are likely BKT are not included (4 from NF Spread Ck and 1 from Upper Mainstem Spread Ck)</span></span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a>all_input <span class="ot">&lt;-</span> all_input <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>indiv <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"OclVARI23G_0013"</span>, <span class="st">"OclVARI23G_0012"</span>, <span class="st">"OclVARI23G_0010"</span>, <span class="st">"OclVARI23G_0011"</span>, <span class="st">"OclVARI23G_0099"</span>))</span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a><span class="fu">### Filter data</span></span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a>Drop putative "mixture" reporting groups</span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>snake_murieranch collection from ~ 2km downstream of UBBC/Blacktail...preliminary self-assignment tests show these samples assign to those streams</span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>lake_na collection from upper lake creek...preliminary self-assignment tests show these samples assign to UBBC, Blacktail, and Cottonwood. </span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>Which makes sense as pretty much all flow at this location derives from Granite Diversion Ditch, which pulls water from just downstream of Moose. </span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>Additionally, spawning and rearing capacity is likely very limited in this system as flow is all but turned off by late summer/early fall after irrigation season. </span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a>all_input <span class="ot">&lt;-</span> all_input <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>repunit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"snake_murieranch"</span>, <span class="st">"lake_NA"</span>))</span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(all_input<span class="sc">$</span>repunit)</span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a>Drop big sibling groups (see BaselineRelatedness.R): retain 2 full siblings per family per Ostergren et al. (2020) Molecular Ecology Resources</span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a>all_input <span class="ot">&lt;-</span> all_input <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>indiv <span class="sc">%in%</span> drop_sibs<span class="sc">$</span>drop_sibs)</span>
<span id="cb47-81"><a href="#cb47-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-82"><a href="#cb47-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-83"><a href="#cb47-83" aria-hidden="true" tabindex="-1"></a>Write out data files</span>
<span id="cb47-86"><a href="#cb47-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-87"><a href="#cb47-87" aria-hidden="true" tabindex="-1"></a><span class="co"># write out</span></span>
<span id="cb47-88"><a href="#cb47-88" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(all_input, <span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/UpperSnakeRiver_GTseq_InputData_NoSibs.csv"</span>)</span>
<span id="cb47-89"><a href="#cb47-89" aria-hidden="true" tabindex="-1"></a>all_input <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/UpperSnakeRiver_GTseq_InputData_NoSibs.csv"</span>)</span>
<span id="cb47-90"><a href="#cb47-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-91"><a href="#cb47-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-92"><a href="#cb47-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-93"><a href="#cb47-93" aria-hidden="true" tabindex="-1"></a><span class="fu">## Define reporting units</span></span>
<span id="cb47-94"><a href="#cb47-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-95"><a href="#cb47-95" aria-hidden="true" tabindex="-1"></a>Drop and redefine reporting units based on sample size, geographic proximity, and low genetic differentiation among proximate populations.</span>
<span id="cb47-96"><a href="#cb47-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-97"><a href="#cb47-97" aria-hidden="true" tabindex="-1"></a>First, identify and combine reporting groups with low sample sizes.</span>
<span id="cb47-100"><a href="#cb47-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-101"><a href="#cb47-101" aria-hidden="true" tabindex="-1"></a>all_input <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(repunit)) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(repunit) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">ct =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">reactable</span>() <span class="sc">%&gt;%</span> <span class="fu">add_title</span>(<span class="st">"Raw, unaltered reporting unit (population) sample sizes."</span>)</span>
<span id="cb47-102"><a href="#cb47-102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-103"><a href="#cb47-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-104"><a href="#cb47-104" aria-hidden="true" tabindex="-1"></a>Redefine reporting groups for groups with ~low sample size AND low self-assignment rates calculated from raw data OR collections from different locations within the same stream. </span>
<span id="cb47-105"><a href="#cb47-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-106"><a href="#cb47-106" aria-hidden="true" tabindex="-1"></a>After running 2nd round of self-assignment tests, drop the groupings that led to reduced self-assignment rates relative to Will's original work treating collections as reporting groups</span>
<span id="cb47-109"><a href="#cb47-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-110"><a href="#cb47-110" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"bluecrane_ford"</span>)] <span class="ot">&lt;-</span> <span class="st">"cody_bluecrane"</span></span>
<span id="cb47-111"><a href="#cb47-111" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"cody_moment"</span>)] <span class="ot">&lt;-</span> <span class="st">"cody_bluecrane"</span></span>
<span id="cb47-112"><a href="#cb47-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-113"><a href="#cb47-113" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"cowboycabin_springchannels"</span>)] <span class="ot">&lt;-</span> <span class="st">"cowboycabin_NA"</span></span>
<span id="cb47-114"><a href="#cb47-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-115"><a href="#cb47-115" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"threechannel_eastfork"</span>)] <span class="ot">&lt;-</span> <span class="st">"threechannel_NA"</span></span>
<span id="cb47-116"><a href="#cb47-116" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"threechannel_westfork"</span>)] <span class="ot">&lt;-</span> <span class="st">"threechannel_NA"</span></span>
<span id="cb47-117"><a href="#cb47-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-118"><a href="#cb47-118" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"fish_lower"</span>)] <span class="ot">&lt;-</span> <span class="st">"fish_NA"</span></span>
<span id="cb47-119"><a href="#cb47-119" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"fish_upper"</span>)] <span class="ot">&lt;-</span> <span class="st">"fish_NA"</span></span>
<span id="cb47-120"><a href="#cb47-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-121"><a href="#cb47-121" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"slate_lower"</span>)] <span class="ot">&lt;-</span> <span class="st">"slate_NA"</span></span>
<span id="cb47-122"><a href="#cb47-122" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"slate_upper"</span>)] <span class="ot">&lt;-</span> <span class="st">"slate_NA"</span></span>
<span id="cb47-123"><a href="#cb47-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-124"><a href="#cb47-124" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"spread_northfork"</span>)] <span class="ot">&lt;-</span> <span class="st">"spreadnf_flagstaff"</span></span>
<span id="cb47-125"><a href="#cb47-125" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"flagstaff_NA"</span>)] <span class="ot">&lt;-</span> <span class="st">"spreadnf_flagstaff"</span></span>
<span id="cb47-126"><a href="#cb47-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-127"><a href="#cb47-127" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"fall_upper"</span>)] <span class="ot">&lt;-</span> <span class="st">"fall_coburn"</span></span>
<span id="cb47-128"><a href="#cb47-128" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"fall_lower"</span>)] <span class="ot">&lt;-</span> <span class="st">"fall_coburn"</span></span>
<span id="cb47-129"><a href="#cb47-129" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"coburn_NA"</span>)] <span class="ot">&lt;-</span> <span class="st">"fall_coburn"</span></span>
<span id="cb47-130"><a href="#cb47-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-131"><a href="#cb47-131" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"littlegreys_lower"</span>)] <span class="ot">&lt;-</span> <span class="st">"littlegreys_steer"</span></span>
<span id="cb47-132"><a href="#cb47-132" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"littlegreys_upper"</span>)] <span class="ot">&lt;-</span> <span class="st">"littlegreys_steer"</span></span>
<span id="cb47-133"><a href="#cb47-133" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"steer_NA"</span>)] <span class="ot">&lt;-</span> <span class="st">"littlegreys_steer"</span></span>
<span id="cb47-134"><a href="#cb47-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-135"><a href="#cb47-135" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"pacific_lower"</span>)] <span class="ot">&lt;-</span> <span class="st">"pacific_NA"</span></span>
<span id="cb47-136"><a href="#cb47-136" aria-hidden="true" tabindex="-1"></a>all_input<span class="sc">$</span>repunit[<span class="fu">which</span>(all_input<span class="sc">$</span>repunit <span class="sc">==</span> <span class="st">"pacific_upper"</span>)] <span class="ot">&lt;-</span> <span class="st">"pacific_NA"</span></span>
<span id="cb47-137"><a href="#cb47-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-138"><a href="#cb47-138" aria-hidden="true" tabindex="-1"></a><span class="co"># drop reporting groups that cannot be easily combined</span></span>
<span id="cb47-139"><a href="#cb47-139" aria-hidden="true" tabindex="-1"></a>all_input <span class="ot">&lt;-</span> all_input <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>repunit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"schwabacher_NA"</span>, <span class="st">"southbuffalofork_NA"</span>, <span class="st">"jack_NA"</span>, <span class="st">"bacon_NA"</span>, <span class="st">"bear_NA"</span>, <span class="st">"sheep_NA"</span>))</span>
<span id="cb47-140"><a href="#cb47-140" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-141"><a href="#cb47-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-144"><a href="#cb47-144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-145"><a href="#cb47-145" aria-hidden="true" tabindex="-1"></a>all_input <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(repunit) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">ct =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">reactable</span>() <span class="sc">%&gt;%</span> <span class="fu">add_title</span>(<span class="st">"Final/combined reporting unit (population) sample sizes."</span>)</span>
<span id="cb47-146"><a href="#cb47-146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-147"><a href="#cb47-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-148"><a href="#cb47-148" aria-hidden="true" tabindex="-1"></a>Write out cleaned data</span>
<span id="cb47-151"><a href="#cb47-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-152"><a href="#cb47-152" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(all_input, <span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/UpperSnakeRiver_GTseq_InputData_NoSibs_clean.csv"</span>)</span>
<span id="cb47-153"><a href="#cb47-153" aria-hidden="true" tabindex="-1"></a>all_input <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/UpperSnakeRiver_GTseq_InputData_NoSibs_clean.csv"</span>)</span>
<span id="cb47-154"><a href="#cb47-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-155"><a href="#cb47-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-156"><a href="#cb47-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-157"><a href="#cb47-157" aria-hidden="true" tabindex="-1"></a><span class="fu">## Delineate sample type</span></span>
<span id="cb47-158"><a href="#cb47-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-159"><a href="#cb47-159" aria-hidden="true" tabindex="-1"></a>Separate reference and mixture samples</span>
<span id="cb47-162"><a href="#cb47-162" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-163"><a href="#cb47-163" aria-hidden="true" tabindex="-1"></a>ref_input <span class="ot">&lt;-</span> all_input[<span class="fu">which</span>(all_input<span class="sc">$</span>sample_type <span class="sc">==</span> <span class="st">"reference"</span>),]</span>
<span id="cb47-164"><a href="#cb47-164" aria-hidden="true" tabindex="-1"></a>mix_input <span class="ot">&lt;-</span> all_input[<span class="fu">which</span>(all_input<span class="sc">$</span>sample_type <span class="sc">==</span> <span class="st">"mixture"</span>),]</span>
<span id="cb47-165"><a href="#cb47-165" aria-hidden="true" tabindex="-1"></a>ref_input <span class="ot">&lt;-</span> ref_input <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.double, as.integer) <span class="co"># make sure everything is an interger</span></span>
<span id="cb47-166"><a href="#cb47-166" aria-hidden="true" tabindex="-1"></a>mix_input <span class="ot">&lt;-</span> mix_input <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.double, as.integer) <span class="co"># make sure everything is an interger</span></span>
<span id="cb47-167"><a href="#cb47-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-168"><a href="#cb47-168" aria-hidden="true" tabindex="-1"></a><span class="co"># view reporting units</span></span>
<span id="cb47-169"><a href="#cb47-169" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(ref_input<span class="sc">$</span>repunit)</span>
<span id="cb47-170"><a href="#cb47-170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-171"><a href="#cb47-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-172"><a href="#cb47-172" aria-hidden="true" tabindex="-1"></a>Write out and read in reference and mixture data files</span>
<span id="cb47-175"><a href="#cb47-175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-176"><a href="#cb47-176" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(ref_input, <span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/UpperSnakeRiver_GTseq_InputData_NoSibs_clean_baseline.csv"</span>)</span>
<span id="cb47-177"><a href="#cb47-177" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(mix_input, <span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/UpperSnakeRiver_GTseq_InputData_NoSibs_clean_mixture.csv"</span>)</span>
<span id="cb47-178"><a href="#cb47-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-179"><a href="#cb47-179" aria-hidden="true" tabindex="-1"></a>ref_input <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/UpperSnakeRiver_GTseq_InputData_NoSibs_clean_baseline.csv"</span>)</span>
<span id="cb47-180"><a href="#cb47-180" aria-hidden="true" tabindex="-1"></a>mix_input <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/UpperSnakeRiver_GTseq_InputData_NoSibs_clean_mixture.csv"</span>)</span>
<span id="cb47-181"><a href="#cb47-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-182"><a href="#cb47-182" aria-hidden="true" tabindex="-1"></a>ref_input <span class="ot">&lt;-</span> ref_input <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.double, as.integer) <span class="co"># make sure everything is an interger</span></span>
<span id="cb47-183"><a href="#cb47-183" aria-hidden="true" tabindex="-1"></a>mix_input <span class="ot">&lt;-</span> mix_input <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.double, as.integer) <span class="co"># make sure everything is an interger</span></span>
<span id="cb47-184"><a href="#cb47-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-185"><a href="#cb47-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-186"><a href="#cb47-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-187"><a href="#cb47-187" aria-hidden="true" tabindex="-1"></a><span class="fu">## Self-assignment tests</span></span>
<span id="cb47-188"><a href="#cb47-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-189"><a href="#cb47-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-190"><a href="#cb47-190" aria-hidden="true" tabindex="-1"></a><span class="fu">### Run self-assignment</span></span>
<span id="cb47-191"><a href="#cb47-191" aria-hidden="true" tabindex="-1"></a>Run the self-assignment tests and summarize results by individual, saving only the most likely inferred rep unit:</span>
<span id="cb47-194"><a href="#cb47-194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-195"><a href="#cb47-195" aria-hidden="true" tabindex="-1"></a>self_test <span class="ot">&lt;-</span> <span class="fu">self_assign</span>(ref_input, <span class="dv">5</span>)</span>
<span id="cb47-196"><a href="#cb47-196" aria-hidden="true" tabindex="-1"></a>self_test_exam <span class="ot">&lt;-</span> self_test <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(indiv) <span class="sc">%&gt;%</span> <span class="fu">top_n</span>(<span class="dv">1</span>, log_likelihood) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb47-197"><a href="#cb47-197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-198"><a href="#cb47-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-199"><a href="#cb47-199" aria-hidden="true" tabindex="-1"></a><span class="fu">### Inspect z-scores</span></span>
<span id="cb47-200"><a href="#cb47-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-201"><a href="#cb47-201" aria-hidden="true" tabindex="-1"></a>Z-scores provide an indication of the likelihood that an individual belongs to a reporting group other than that to which it was assigned. Because we are performing self-assignment tests, we would not expect to see any major outliers. </span>
<span id="cb47-202"><a href="#cb47-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width = 9, fig.height = 5}</span></span>
<span id="cb47-203"><a href="#cb47-203" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Distribution of z-scores by population"</span></span>
<span id="cb47-204"><a href="#cb47-204" aria-hidden="true" tabindex="-1"></a><span class="in">p1 &lt;- ggplot(self_test_exam, aes(x = repunit, y = z_score)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))</span></span>
<span id="cb47-205"><a href="#cb47-205" aria-hidden="true" tabindex="-1"></a><span class="in">print(p1)</span></span>
<span id="cb47-206"><a href="#cb47-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-207"><a href="#cb47-207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, message=FALSE, results='hide'}</span></span>
<span id="cb47-208"><a href="#cb47-208" aria-hidden="true" tabindex="-1"></a><span class="in">jpeg("/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Self Assignment/self_assign_zscore_boxplot.jpg", res = 1000, units = "in", width = 9, height = 5)</span></span>
<span id="cb47-209"><a href="#cb47-209" aria-hidden="true" tabindex="-1"></a><span class="in">p1</span></span>
<span id="cb47-210"><a href="#cb47-210" aria-hidden="true" tabindex="-1"></a><span class="in">dev.off()</span></span>
<span id="cb47-211"><a href="#cb47-211" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-212"><a href="#cb47-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-213"><a href="#cb47-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-214"><a href="#cb47-214" aria-hidden="true" tabindex="-1"></a><span class="fu">### Self-assignment likelihood</span></span>
<span id="cb47-215"><a href="#cb47-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-216"><a href="#cb47-216" aria-hidden="true" tabindex="-1"></a>Do individuals generally assign to their source reporting unit with high assignment likelihood? Expectation is the mean/median should be near 1, anything much lower would be cause for concern.</span>
<span id="cb47-217"><a href="#cb47-217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width = 5, fig.height = 5}</span></span>
<span id="cb47-218"><a href="#cb47-218" aria-hidden="true" tabindex="-1"></a><span class="in"># Distribution of assignment likelihood</span></span>
<span id="cb47-219"><a href="#cb47-219" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Distribution of indvidual assignment likelihoods."</span></span>
<span id="cb47-220"><a href="#cb47-220" aria-hidden="true" tabindex="-1"></a><span class="in">p1 &lt;- hist(self_test_exam$scaled_likelihood) # probability of assignment to a single reporting group is very high for nearly all individuals</span></span>
<span id="cb47-221"><a href="#cb47-221" aria-hidden="true" tabindex="-1"></a><span class="in">plot(p1, main = paste(paste("Mean = ", round(mean(self_test_exam$scaled_likelihood), digits = 3), "; Median = ", round(median(self_test_exam$scaled_likelihood), digits = 3), sep = "")))</span></span>
<span id="cb47-222"><a href="#cb47-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-223"><a href="#cb47-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-224"><a href="#cb47-224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  echo=FALSE, message=FALSE, results='hide'}</span></span>
<span id="cb47-225"><a href="#cb47-225" aria-hidden="true" tabindex="-1"></a><span class="in">jpeg("/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Self Assignment/self_assign_likelhood_hist.jpg", res = 1000, units = "in", width = 5, height = 5)</span></span>
<span id="cb47-226"><a href="#cb47-226" aria-hidden="true" tabindex="-1"></a><span class="in">plot(p1, main = paste(paste("Mean = ", round(mean(self_test_exam$scaled_likelihood), digits = 3), "; Median = ", round(median(self_test_exam$scaled_likelihood), digits = 3), sep = "")))</span></span>
<span id="cb47-227"><a href="#cb47-227" aria-hidden="true" tabindex="-1"></a><span class="in">dev.off()</span></span>
<span id="cb47-228"><a href="#cb47-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-229"><a href="#cb47-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-230"><a href="#cb47-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-231"><a href="#cb47-231" aria-hidden="true" tabindex="-1"></a><span class="fu">### Accuracy and efficiency</span></span>
<span id="cb47-232"><a href="#cb47-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-233"><a href="#cb47-233" aria-hidden="true" tabindex="-1"></a>Inspect self-assignment accuracy and efficiency by reporting group.</span>
<span id="cb47-234"><a href="#cb47-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-235"><a href="#cb47-235" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>*Efficiency:* the number of individuals known to belong to a reporting group which were recovered from the mixture.</span>
<span id="cb47-236"><a href="#cb47-236" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>*Accuracy:* the proportion of individuals correctly assigned to a reporting group</span>
<span id="cb47-237"><a href="#cb47-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-238"><a href="#cb47-238" aria-hidden="true" tabindex="-1"></a>First, summarize results by reporting group:</span>
<span id="cb47-241"><a href="#cb47-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-242"><a href="#cb47-242" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize results by reporting group</span></span>
<span id="cb47-243"><a href="#cb47-243" aria-hidden="true" tabindex="-1"></a>ref_pops <span class="ot">&lt;-</span> <span class="fu">unique</span>(self_test_exam<span class="sc">$</span>repunit)</span>
<span id="cb47-244"><a href="#cb47-244" aria-hidden="true" tabindex="-1"></a>prop_assigned_acc <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(ref_pops))</span>
<span id="cb47-245"><a href="#cb47-245" aria-hidden="true" tabindex="-1"></a>prop_assigned_eff <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(ref_pops))</span>
<span id="cb47-246"><a href="#cb47-246" aria-hidden="true" tabindex="-1"></a>sampsize <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(ref_pops))</span>
<span id="cb47-247"><a href="#cb47-247" aria-hidden="true" tabindex="-1"></a>selfassprop <span class="ot">&lt;-</span> <span class="fu">tibble</span>(ref_pops, prop_assigned_acc, prop_assigned_eff, sampsize)</span>
<span id="cb47-248"><a href="#cb47-248" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(selfassprop)[<span class="dv">1</span>]) {</span>
<span id="cb47-249"><a href="#cb47-249" aria-hidden="true" tabindex="-1"></a>  corass <span class="ot">&lt;-</span> self_test_exam[<span class="fu">which</span>(self_test_exam<span class="sc">$</span>repunit <span class="sc">==</span> ref_pops[i]),] <span class="co"># fish known to be from a given reporting unit</span></span>
<span id="cb47-250"><a href="#cb47-250" aria-hidden="true" tabindex="-1"></a>  totass <span class="ot">&lt;-</span> self_test_exam[<span class="fu">which</span>(self_test_exam<span class="sc">$</span>inferred_repunit <span class="sc">==</span> ref_pops[i]),] <span class="co"># fish assigned to a given reporting unit</span></span>
<span id="cb47-251"><a href="#cb47-251" aria-hidden="true" tabindex="-1"></a>  selfassprop<span class="sc">$</span>prop_assigned_eff[i] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(corass<span class="sc">$</span>repunit <span class="sc">==</span> corass<span class="sc">$</span>inferred_repunit)) <span class="sc">/</span> <span class="fu">nrow</span>(corass) <span class="co"># Efficiency - the number of individuals known to belong to a reporting group which were recovered from the mixture</span></span>
<span id="cb47-252"><a href="#cb47-252" aria-hidden="true" tabindex="-1"></a>  selfassprop<span class="sc">$</span>prop_assigned_acc[i] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(totass<span class="sc">$</span>repunit <span class="sc">==</span> totass<span class="sc">$</span>inferred_repunit)) <span class="sc">/</span> <span class="fu">nrow</span>(totass) <span class="co"># Accuracy - the proportion of individuals correctly assigned to a reporting group</span></span>
<span id="cb47-253"><a href="#cb47-253" aria-hidden="true" tabindex="-1"></a>  selfassprop<span class="sc">$</span>sampsize[i] <span class="ot">&lt;-</span> <span class="fu">nrow</span>(corass)</span>
<span id="cb47-254"><a href="#cb47-254" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-255"><a href="#cb47-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-256"><a href="#cb47-256" aria-hidden="true" tabindex="-1"></a><span class="co"># add coordinates for sorting</span></span>
<span id="cb47-257"><a href="#cb47-257" aria-hidden="true" tabindex="-1"></a>selfassprop <span class="ot">&lt;-</span> selfassprop <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(gps, <span class="at">by =</span> <span class="fu">join_by</span>(ref_pops <span class="sc">==</span> repunit)) </span>
<span id="cb47-258"><a href="#cb47-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-259"><a href="#cb47-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-260"><a href="#cb47-260" aria-hidden="true" tabindex="-1"></a>Self-assignment efficiency, weighted mean: </span>
<span id="cb47-263"><a href="#cb47-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-264"><a href="#cb47-264" aria-hidden="true" tabindex="-1"></a><span class="fu">weighted.mean</span>(selfassprop<span class="sc">$</span>prop_assigned_eff, selfassprop<span class="sc">$</span>sampsize<span class="sc">/</span><span class="fu">sum</span>(selfassprop<span class="sc">$</span>sampsize), <span class="at">na.rm =</span> T)</span>
<span id="cb47-265"><a href="#cb47-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-266"><a href="#cb47-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-267"><a href="#cb47-267" aria-hidden="true" tabindex="-1"></a>Self-assignment accuracy, weighted mean: </span>
<span id="cb47-270"><a href="#cb47-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-271"><a href="#cb47-271" aria-hidden="true" tabindex="-1"></a><span class="fu">weighted.mean</span>(selfassprop<span class="sc">$</span>prop_assigned_acc, selfassprop<span class="sc">$</span>sampsize<span class="sc">/</span><span class="fu">sum</span>(selfassprop<span class="sc">$</span>sampsize), <span class="at">na.rm =</span> T)</span>
<span id="cb47-272"><a href="#cb47-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-273"><a href="#cb47-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-274"><a href="#cb47-274" aria-hidden="true" tabindex="-1"></a>How does reporting group accuracy and efficiency scale with sample size? Generally positively, but relationships with sample size are weak. I.e., even reporting groups with small sample sizes have relatively high accuracy/efficiency and thus low acc/eff are likely not a function of sample size.</span>
<span id="cb47-275"><a href="#cb47-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width = 8, fig.height = 4}</span></span>
<span id="cb47-276"><a href="#cb47-276" aria-hidden="true" tabindex="-1"></a><span class="in">par(mar = c(4,4,1,1), mgp = c(2.5,1,0), mfrow = c(1,2))</span></span>
<span id="cb47-277"><a href="#cb47-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-278"><a href="#cb47-278" aria-hidden="true" tabindex="-1"></a><span class="in">plot(prop_assigned_eff ~ sampsize, selfassprop, xlab = "Sample Size", ylab = "Self-Assignment Efficiency")</span></span>
<span id="cb47-279"><a href="#cb47-279" aria-hidden="true" tabindex="-1"></a><span class="in">legend("bottomright", legend = paste("Weighted Mean Eff. = ", round(weighted.mean(selfassprop$prop_assigned_eff, selfassprop$sampsize/sum(selfassprop$sampsize), na.rm = T), digits = 3)), bty = "n")</span></span>
<span id="cb47-280"><a href="#cb47-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-281"><a href="#cb47-281" aria-hidden="true" tabindex="-1"></a><span class="in">plot(prop_assigned_acc ~ sampsize, selfassprop, xlab = "Sample Size", ylab = "Self-Assignment Accuracy")</span></span>
<span id="cb47-282"><a href="#cb47-282" aria-hidden="true" tabindex="-1"></a><span class="in">legend("bottomright", legend = paste("Weighted Mean Acc. = ", round(weighted.mean(selfassprop$prop_assigned_acc, selfassprop$sampsize/sum(selfassprop$sampsize), na.rm = T), digits = 3)), bty = "n")</span></span>
<span id="cb47-283"><a href="#cb47-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-284"><a href="#cb47-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-285"><a href="#cb47-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  echo=FALSE, message=FALSE, results='hide'}</span></span>
<span id="cb47-286"><a href="#cb47-286" aria-hidden="true" tabindex="-1"></a><span class="in">jpeg("/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Self Assignment/self_assign_accuracy_efficiency_scatter.jpg", res = 1000, units = "in", width = 8, height = 4)</span></span>
<span id="cb47-287"><a href="#cb47-287" aria-hidden="true" tabindex="-1"></a><span class="in">par(mar = c(4,4,1,1), mgp = c(2.5,1,0), mfrow = c(1,2))</span></span>
<span id="cb47-288"><a href="#cb47-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-289"><a href="#cb47-289" aria-hidden="true" tabindex="-1"></a><span class="in">plot(prop_assigned_eff ~ sampsize, selfassprop, xlab = "Sample Size", ylab = "Self-Assignment Efficiency")</span></span>
<span id="cb47-290"><a href="#cb47-290" aria-hidden="true" tabindex="-1"></a><span class="in">legend("bottomright", legend = paste("Weighted Mean Eff. = ", round(weighted.mean(selfassprop$prop_assigned_eff, selfassprop$sampsize/sum(selfassprop$sampsize), na.rm = T), digits = 3)), bty = "n")</span></span>
<span id="cb47-291"><a href="#cb47-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-292"><a href="#cb47-292" aria-hidden="true" tabindex="-1"></a><span class="in">plot(prop_assigned_acc ~ sampsize, selfassprop, xlab = "Sample Size", ylab = "Self-Assignment Accuracy")</span></span>
<span id="cb47-293"><a href="#cb47-293" aria-hidden="true" tabindex="-1"></a><span class="in">legend("bottomright", legend = paste("Weighted Mean Acc. = ", round(weighted.mean(selfassprop$prop_assigned_acc, selfassprop$sampsize/sum(selfassprop$sampsize), na.rm = T), digits = 3)), bty = "n")</span></span>
<span id="cb47-294"><a href="#cb47-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-295"><a href="#cb47-295" aria-hidden="true" tabindex="-1"></a><span class="in">dev.off()</span></span>
<span id="cb47-296"><a href="#cb47-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-297"><a href="#cb47-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-298"><a href="#cb47-298" aria-hidden="true" tabindex="-1"></a>View accuracy and efficiency by reporting group:</span>
<span id="cb47-299"><a href="#cb47-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r , fig.width = 9, fig.height = 5}</span></span>
<span id="cb47-300"><a href="#cb47-300" aria-hidden="true" tabindex="-1"></a><span class="in">selfassprop_gather &lt;- selfassprop %&gt;% gather(type, value, prop_assigned_acc:prop_assigned_eff)</span></span>
<span id="cb47-301"><a href="#cb47-301" aria-hidden="true" tabindex="-1"></a><span class="in">selfassprop_gather %&gt;% ggplot() + geom_bar(aes(x = ref_pops, y = value, fill = type), stat = "identity", position = "dodge") + </span></span>
<span id="cb47-302"><a href="#cb47-302" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Reporting Group") + ylab("Accuracy or Efficiency") + theme_bw() +</span></span>
<span id="cb47-303"><a href="#cb47-303" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "top") + </span></span>
<span id="cb47-304"><a href="#cb47-304" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_discrete(name = "", labels = c("Accuracy", "Efficiency"))</span></span>
<span id="cb47-305"><a href="#cb47-305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-306"><a href="#cb47-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  echo=FALSE, message=FALSE, results='hide'}</span></span>
<span id="cb47-307"><a href="#cb47-307" aria-hidden="true" tabindex="-1"></a><span class="in">jpeg("/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Self Assignment/self_assign_AccEff_barplot.jpg", res = 1000, units = "in", width = 9, height = 5)</span></span>
<span id="cb47-308"><a href="#cb47-308" aria-hidden="true" tabindex="-1"></a><span class="in">selfassprop_gather %&gt;% ggplot() + geom_bar(aes(x = ref_pops, y = value, fill = type), stat = "identity", position = "dodge") + </span></span>
<span id="cb47-309"><a href="#cb47-309" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Reporting Group") + ylab("Accuracy or Efficiency") + theme_bw() +</span></span>
<span id="cb47-310"><a href="#cb47-310" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "top") + </span></span>
<span id="cb47-311"><a href="#cb47-311" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_discrete(name = "", labels = c("Accuracy", "Efficiency"))</span></span>
<span id="cb47-312"><a href="#cb47-312" aria-hidden="true" tabindex="-1"></a><span class="in">dev.off()</span></span>
<span id="cb47-313"><a href="#cb47-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-314"><a href="#cb47-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-315"><a href="#cb47-315" aria-hidden="true" tabindex="-1"></a>Reproduce the plot above, but only show accuracy and use numbered reporting groups, by latitude (for supplementary materials).</span>
<span id="cb47-316"><a href="#cb47-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r , fig.width = 9, fig.height = 3}</span></span>
<span id="cb47-317"><a href="#cb47-317" aria-hidden="true" tabindex="-1"></a><span class="in">selfassprop %&gt;% ggplot() + geom_bar(aes(x = reorder(ref_pops, -lat), y = prop_assigned_acc), stat = "identity", position = "dodge", color = "black", fill = "grey") + </span></span>
<span id="cb47-318"><a href="#cb47-318" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Reporting unit") + ylab("Self-assignment accuracy") + theme_bw() +</span></span>
<span id="cb47-319"><a href="#cb47-319" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "top") + </span></span>
<span id="cb47-320"><a href="#cb47-320" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_discrete(labels = c(1:52))</span></span>
<span id="cb47-321"><a href="#cb47-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-322"><a href="#cb47-322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r   echo=FALSE, message=FALSE, results='hide'}</span></span>
<span id="cb47-323"><a href="#cb47-323" aria-hidden="true" tabindex="-1"></a><span class="in">jpeg("/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Self Assignment/self_assign_Acc_barplot.jpg", res = 1000, units = "in", width = 9, height = 3)</span></span>
<span id="cb47-324"><a href="#cb47-324" aria-hidden="true" tabindex="-1"></a><span class="in">selfassprop %&gt;% ggplot() + geom_bar(aes(x = reorder(ref_pops, -lat), y = prop_assigned_acc), stat = "identity", position = "dodge", color = "black", fill = "grey") + </span></span>
<span id="cb47-325"><a href="#cb47-325" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Reporting unit") + ylab("Self-assignment accuracy") + theme_bw() +</span></span>
<span id="cb47-326"><a href="#cb47-326" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "top") + </span></span>
<span id="cb47-327"><a href="#cb47-327" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_discrete(labels = c(1:52))</span></span>
<span id="cb47-328"><a href="#cb47-328" aria-hidden="true" tabindex="-1"></a><span class="in">dev.off()</span></span>
<span id="cb47-329"><a href="#cb47-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-330"><a href="#cb47-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-331"><a href="#cb47-331" aria-hidden="true" tabindex="-1"></a>Write-out self-assignment test results</span>
<span id="cb47-334"><a href="#cb47-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-335"><a href="#cb47-335" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(self_test_exam[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)], <span class="at">file =</span> <span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Self Assignment/self_assign_results_individuals.csv"</span>)</span>
<span id="cb47-336"><a href="#cb47-336" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(selfassprop, <span class="at">file =</span> <span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Self Assignment/self_assign_results_repgroups.csv"</span>)</span>
<span id="cb47-337"><a href="#cb47-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-338"><a href="#cb47-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-339"><a href="#cb47-339" aria-hidden="true" tabindex="-1"></a><span class="fu">### Confusion matrix</span></span>
<span id="cb47-340"><a href="#cb47-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-341"><a href="#cb47-341" aria-hidden="true" tabindex="-1"></a>Construct self-assignment confusion matrix: to which reporting units are individuals of known-origin being (mistakenly) assigned?</span>
<span id="cb47-344"><a href="#cb47-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-345"><a href="#cb47-345" aria-hidden="true" tabindex="-1"></a>conf_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(<span class="fu">unique</span>(self_test_exam<span class="sc">$</span>repunit)), <span class="at">ncol =</span> <span class="fu">length</span>(<span class="fu">unique</span>(self_test_exam<span class="sc">$</span>repunit)))</span>
<span id="cb47-346"><a href="#cb47-346" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(conf_mat) <span class="ot">&lt;-</span> selfassprop<span class="sc">$</span>ref_pops</span>
<span id="cb47-347"><a href="#cb47-347" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(conf_mat) <span class="ot">&lt;-</span> selfassprop<span class="sc">$</span>ref_pops</span>
<span id="cb47-348"><a href="#cb47-348" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(conf_mat)){</span>
<span id="cb47-349"><a href="#cb47-349" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(conf_mat)){</span>
<span id="cb47-350"><a href="#cb47-350" aria-hidden="true" tabindex="-1"></a>    conf_mat[i,j] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(self_test_exam<span class="sc">$</span>repunit <span class="sc">==</span> <span class="fu">rownames</span>(conf_mat)[i] <span class="sc">&amp;</span> self_test_exam<span class="sc">$</span>inferred_repunit <span class="sc">==</span> <span class="fu">colnames</span>(conf_mat)[j]))<span class="sc">/</span><span class="fu">length</span>(<span class="fu">which</span>(self_test_exam<span class="sc">$</span>repunit <span class="sc">==</span> <span class="fu">rownames</span>(conf_mat)[i]))</span>
<span id="cb47-351"><a href="#cb47-351" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-352"><a href="#cb47-352" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-353"><a href="#cb47-353" aria-hidden="true" tabindex="-1"></a><span class="co"># check confusion matrix -- all rows should add to 1</span></span>
<span id="cb47-354"><a href="#cb47-354" aria-hidden="true" tabindex="-1"></a><span class="co"># check &lt;- apply(conf_mat, 1, sum)</span></span>
<span id="cb47-355"><a href="#cb47-355" aria-hidden="true" tabindex="-1"></a><span class="co"># table(check == 1)</span></span>
<span id="cb47-356"><a href="#cb47-356" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(<span class="fu">round</span>(conf_mat, <span class="at">digits =</span> <span class="dv">3</span>))</span>
<span id="cb47-357"><a href="#cb47-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-358"><a href="#cb47-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-359"><a href="#cb47-359" aria-hidden="true" tabindex="-1"></a>Write out confusion matrix</span>
<span id="cb47-362"><a href="#cb47-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-363"><a href="#cb47-363" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(conf_mat, <span class="at">file =</span> <span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Self Assignment/self_assign_confusion_matrix.csv"</span>, <span class="at">row.names =</span> T, <span class="at">quote =</span> F)</span>
<span id="cb47-364"><a href="#cb47-364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-365"><a href="#cb47-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-366"><a href="#cb47-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-367"><a href="#cb47-367" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulated mixtures</span></span>
<span id="cb47-368"><a href="#cb47-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-369"><a href="#cb47-369" aria-hidden="true" tabindex="-1"></a>Evaluate accuracy given our set of SNP markers and the grouping of collections into reporting groups</span>
<span id="cb47-370"><a href="#cb47-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-371"><a href="#cb47-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-372"><a href="#cb47-372" aria-hidden="true" tabindex="-1"></a><span class="fu">### Run simulations</span></span>
<span id="cb47-373"><a href="#cb47-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-374"><a href="#cb47-374" aria-hidden="true" tabindex="-1"></a>First, simulate mixtures and assign to reporting groups</span>
<span id="cb47-375"><a href="#cb47-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r cache.lazy=FALSE}</span></span>
<span id="cb47-376"><a href="#cb47-376" aria-hidden="true" tabindex="-1"></a><span class="in"># usr_sims &lt;- assess_reference_loo(reference = ref_input, gen_start_col = 5, reps = 500, mixsize = 1000, return_indiv_posteriors = TRUE)</span></span>
<span id="cb47-377"><a href="#cb47-377" aria-hidden="true" tabindex="-1"></a><span class="in"># write_rds(usr_sims, "/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Simulated Mixtures/sim_mix.rds")</span></span>
<span id="cb47-378"><a href="#cb47-378" aria-hidden="true" tabindex="-1"></a><span class="in">usr_sims &lt;- read_rds("/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Simulated Mixtures/sim_mix.rds")</span></span>
<span id="cb47-379"><a href="#cb47-379" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-380"><a href="#cb47-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-381"><a href="#cb47-381" aria-hidden="true" tabindex="-1"></a>Number of simulations</span>
<span id="cb47-384"><a href="#cb47-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-385"><a href="#cb47-385" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(usr_sims<span class="sc">$</span>mixing_proportions<span class="sc">$</span>iter))</span>
<span id="cb47-386"><a href="#cb47-386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-387"><a href="#cb47-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-388"><a href="#cb47-388" aria-hidden="true" tabindex="-1"></a><span class="fu">### Global results</span></span>
<span id="cb47-389"><a href="#cb47-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-390"><a href="#cb47-390" aria-hidden="true" tabindex="-1"></a>Mean squared error:</span>
<span id="cb47-393"><a href="#cb47-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-394"><a href="#cb47-394" aria-hidden="true" tabindex="-1"></a>(<span class="fu">sum</span>((usr_sims<span class="sc">$</span>mixing_proportions<span class="sc">$</span>post_mean_pi <span class="sc">-</span> usr_sims<span class="sc">$</span>mixing_proportions<span class="sc">$</span>true_pi)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">length</span>(<span class="fu">unique</span>(usr_sims<span class="sc">$</span>mixing_proportions<span class="sc">$</span>iter)))</span>
<span id="cb47-395"><a href="#cb47-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-396"><a href="#cb47-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-397"><a href="#cb47-397" aria-hidden="true" tabindex="-1"></a>Mean residual:</span>
<span id="cb47-400"><a href="#cb47-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-401"><a href="#cb47-401" aria-hidden="true" tabindex="-1"></a>(<span class="fu">sum</span>((usr_sims<span class="sc">$</span>mixing_proportions<span class="sc">$</span>post_mean_pi <span class="sc">-</span> usr_sims<span class="sc">$</span>mixing_proportions<span class="sc">$</span>true_pi)) <span class="sc">/</span> <span class="fu">length</span>(<span class="fu">unique</span>(usr_sims<span class="sc">$</span>mixing_proportions<span class="sc">$</span>iter))) </span>
<span id="cb47-402"><a href="#cb47-402" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-403"><a href="#cb47-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-404"><a href="#cb47-404" aria-hidden="true" tabindex="-1"></a>Plot estimated proportional contribution against true contribution for all simulations and populations</span>
<span id="cb47-405"><a href="#cb47-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width = 5, fig.height = 5}</span></span>
<span id="cb47-406"><a href="#cb47-406" aria-hidden="true" tabindex="-1"></a><span class="in">plot(post_mean_pi ~ true_pi, usr_sims$mixing_proportions, xlab = "True Mixing Proportion", ylab = "Posterior Mean Mixing Proportion")</span></span>
<span id="cb47-407"><a href="#cb47-407" aria-hidden="true" tabindex="-1"></a><span class="in">abline(a = 0, b = 1, col = "red")</span></span>
<span id="cb47-408"><a href="#cb47-408" aria-hidden="true" tabindex="-1"></a><span class="in">legend("topleft", legend = paste("MSE = ", round((sum((usr_sims$mixing_proportions$post_mean_pi - usr_sims$mixing_proportions$true_pi)^2) / length(unique(usr_sims$mixing_proportions$iter))), digits = 4), sep = ""), bty = "n")</span></span>
<span id="cb47-409"><a href="#cb47-409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-410"><a href="#cb47-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, message=FALSE, results='hide'}</span></span>
<span id="cb47-411"><a href="#cb47-411" aria-hidden="true" tabindex="-1"></a><span class="in">jpeg("/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Simulated Mixtures/sim_mix_all_scatter.jpg", res = 1000, units = "in", width = 5, height = 5)</span></span>
<span id="cb47-412"><a href="#cb47-412" aria-hidden="true" tabindex="-1"></a><span class="in">plot(post_mean_pi ~ true_pi, usr_sims$mixing_proportions, xlab = "True Mixing Proportion", ylab = "Posterior Mean Mixing Proportion")</span></span>
<span id="cb47-413"><a href="#cb47-413" aria-hidden="true" tabindex="-1"></a><span class="in">abline(a = 0, b = 1, col = "red")</span></span>
<span id="cb47-414"><a href="#cb47-414" aria-hidden="true" tabindex="-1"></a><span class="in">legend("topleft", legend = paste("MSE = ", round((sum((usr_sims$mixing_proportions$post_mean_pi - usr_sims$mixing_proportions$true_pi)^2) / length(unique(usr_sims$mixing_proportions$iter))), digits = 4), sep = ""), bty = "n")</span></span>
<span id="cb47-415"><a href="#cb47-415" aria-hidden="true" tabindex="-1"></a><span class="in">dev.off()</span></span>
<span id="cb47-416"><a href="#cb47-416" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-417"><a href="#cb47-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-418"><a href="#cb47-418" aria-hidden="true" tabindex="-1"></a><span class="fu">### By reporting group</span></span>
<span id="cb47-419"><a href="#cb47-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-420"><a href="#cb47-420" aria-hidden="true" tabindex="-1"></a>Summarize by reporting group and write to file</span>
<span id="cb47-423"><a href="#cb47-423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-424"><a href="#cb47-424" aria-hidden="true" tabindex="-1"></a>tmp0 <span class="ot">&lt;-</span> usr_sims<span class="sc">$</span>mixing_proportions <span class="sc">%&gt;%</span> </span>
<span id="cb47-425"><a href="#cb47-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(repunit) <span class="sc">%&gt;%</span> </span>
<span id="cb47-426"><a href="#cb47-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mse =</span> <span class="fu">sum</span>((post_mean_pi <span class="sc">-</span> true_pi)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">length</span>(<span class="fu">unique</span>(iter)),</span>
<span id="cb47-427"><a href="#cb47-427" aria-hidden="true" tabindex="-1"></a>            <span class="at">mr =</span> <span class="fu">sum</span>((post_mean_pi <span class="sc">-</span> true_pi)) <span class="sc">/</span> <span class="fu">length</span>(<span class="fu">unique</span>(iter)),</span>
<span id="cb47-428"><a href="#cb47-428" aria-hidden="true" tabindex="-1"></a>            <span class="at">mr.sd =</span> <span class="fu">sd</span>(post_mean_pi <span class="sc">-</span> true_pi),</span>
<span id="cb47-429"><a href="#cb47-429" aria-hidden="true" tabindex="-1"></a>            <span class="at">mr.025 =</span> <span class="fu">quantile</span>(post_mean_pi <span class="sc">-</span> true_pi, <span class="fl">0.025</span>),</span>
<span id="cb47-430"><a href="#cb47-430" aria-hidden="true" tabindex="-1"></a>            <span class="at">mr.975 =</span> <span class="fu">quantile</span>(post_mean_pi <span class="sc">-</span> true_pi, <span class="fl">0.975</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-431"><a href="#cb47-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb47-432"><a href="#cb47-432" aria-hidden="true" tabindex="-1"></a>tmp0 <span class="ot">&lt;-</span> tmp0 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(gps) </span>
<span id="cb47-433"><a href="#cb47-433" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(tmp0, <span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Simulated Mixtures/sim_mix_repgroup_msemr.csv"</span>)</span>
<span id="cb47-434"><a href="#cb47-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-435"><a href="#cb47-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-436"><a href="#cb47-436" aria-hidden="true" tabindex="-1"></a>Mean square error by reporting group</span>
<span id="cb47-437"><a href="#cb47-437" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width = 9, fig.height = 5}</span></span>
<span id="cb47-438"><a href="#cb47-438" aria-hidden="true" tabindex="-1"></a><span class="in">tmp0 %&gt;% ggplot() + </span></span>
<span id="cb47-439"><a href="#cb47-439" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(aes(x = repunit, y = mse), stat = "identity", fill = "grey70", color = "black") +</span></span>
<span id="cb47-440"><a href="#cb47-440" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Reporting Group") + ylab("Mean square error") + theme_bw() +</span></span>
<span id="cb47-441"><a href="#cb47-441" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))</span></span>
<span id="cb47-442"><a href="#cb47-442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-443"><a href="#cb47-443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, message=FALSE, results='hide'}</span></span>
<span id="cb47-444"><a href="#cb47-444" aria-hidden="true" tabindex="-1"></a><span class="in">jpeg("/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Simulated Mixtures/sim_mix_mse_barplot.jpg", res = 1000, units = "in", width = 9, height = 5)</span></span>
<span id="cb47-445"><a href="#cb47-445" aria-hidden="true" tabindex="-1"></a><span class="in">tmp0 %&gt;% ggplot() + </span></span>
<span id="cb47-446"><a href="#cb47-446" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(aes(x = repunit, y = mse), stat = "identity", fill = "grey70", color = "black") +</span></span>
<span id="cb47-447"><a href="#cb47-447" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Reporting Group") + ylab("Mean square error") + theme_bw() +</span></span>
<span id="cb47-448"><a href="#cb47-448" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))</span></span>
<span id="cb47-449"><a href="#cb47-449" aria-hidden="true" tabindex="-1"></a><span class="in">dev.off()</span></span>
<span id="cb47-450"><a href="#cb47-450" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-451"><a href="#cb47-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-452"><a href="#cb47-452" aria-hidden="true" tabindex="-1"></a>Mean residual by reporting group</span>
<span id="cb47-453"><a href="#cb47-453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width = 9, fig.height = 5}</span></span>
<span id="cb47-454"><a href="#cb47-454" aria-hidden="true" tabindex="-1"></a><span class="in">tmp0 %&gt;% ggplot() + </span></span>
<span id="cb47-455"><a href="#cb47-455" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(aes(x = repunit, y = mr), stat = "identity", fill = "grey70", color = "black") +</span></span>
<span id="cb47-456"><a href="#cb47-456" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Reporting Group") + ylab("Mean residual") + theme_bw() +</span></span>
<span id="cb47-457"><a href="#cb47-457" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))</span></span>
<span id="cb47-458"><a href="#cb47-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-459"><a href="#cb47-459" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, message=FALSE, results='hide'}</span></span>
<span id="cb47-460"><a href="#cb47-460" aria-hidden="true" tabindex="-1"></a><span class="in">jpeg("/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Simulated Mixtures/sim_mix_mr_barplot.jpg", res = 1000, units = "in", width = 9, height = 5)</span></span>
<span id="cb47-461"><a href="#cb47-461" aria-hidden="true" tabindex="-1"></a><span class="in">tmp0 %&gt;% ggplot() + </span></span>
<span id="cb47-462"><a href="#cb47-462" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(aes(x = repunit, y = mr), stat = "identity", fill = "grey70", color = "black") +</span></span>
<span id="cb47-463"><a href="#cb47-463" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Reporting Group") + ylab("Mean residual") + theme_bw() +</span></span>
<span id="cb47-464"><a href="#cb47-464" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))</span></span>
<span id="cb47-465"><a href="#cb47-465" aria-hidden="true" tabindex="-1"></a><span class="in">dev.off()</span></span>
<span id="cb47-466"><a href="#cb47-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-467"><a href="#cb47-467" aria-hidden="true" tabindex="-1"></a>Mean residual by reporting group (same as above), but numbered reporting groups with standard deviations</span>
<span id="cb47-468"><a href="#cb47-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=9, fig.height=4}</span></span>
<span id="cb47-469"><a href="#cb47-469" aria-hidden="true" tabindex="-1"></a><span class="in">tmp0 %&gt;% ggplot(aes(x = reorder(repunit, -lat), y = mr)) + </span></span>
<span id="cb47-470"><a href="#cb47-470" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat = "identity", fill = "grey70", color = "black") +</span></span>
<span id="cb47-471"><a href="#cb47-471" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Reporting unit") + ylab("Mean residual") + theme_bw() +</span></span>
<span id="cb47-472"><a href="#cb47-472" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +</span></span>
<span id="cb47-473"><a href="#cb47-473" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_discrete(labels = c(1:52)) +</span></span>
<span id="cb47-474"><a href="#cb47-474" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_errorbar(aes(ymin = mr - mr.sd, ymax = mr + mr.sd), width = 0.4)</span></span>
<span id="cb47-475"><a href="#cb47-475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-476"><a href="#cb47-476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, message=FALSE, results='hide'}</span></span>
<span id="cb47-477"><a href="#cb47-477" aria-hidden="true" tabindex="-1"></a><span class="in">jpeg("/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Simulated Mixtures/sim_mix_mr_barplot_stdev_numbered.jpg", res = 1000, units = "in", width = 9, height = 4)</span></span>
<span id="cb47-478"><a href="#cb47-478" aria-hidden="true" tabindex="-1"></a><span class="in">tmp0 %&gt;% ggplot(aes(x = reorder(repunit, -lat), y = mr)) + </span></span>
<span id="cb47-479"><a href="#cb47-479" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat = "identity", fill = "grey70", color = "black") +</span></span>
<span id="cb47-480"><a href="#cb47-480" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Reporting unit") + ylab("Mean residual") + theme_bw() +</span></span>
<span id="cb47-481"><a href="#cb47-481" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +</span></span>
<span id="cb47-482"><a href="#cb47-482" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_discrete(labels = c(1:52)) +</span></span>
<span id="cb47-483"><a href="#cb47-483" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_errorbar(aes(ymin = mr - mr.sd, ymax = mr + mr.sd), width = 0.4)</span></span>
<span id="cb47-484"><a href="#cb47-484" aria-hidden="true" tabindex="-1"></a><span class="in">dev.off()</span></span>
<span id="cb47-485"><a href="#cb47-485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-486"><a href="#cb47-486" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, message=FALSE, results='hide'}</span></span>
<span id="cb47-487"><a href="#cb47-487" aria-hidden="true" tabindex="-1"></a><span class="in">jpeg("/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Simulated Mixtures/sim_mix_mr_barplot_95quantiles.jpg", res = 1000, units = "in", width = 9, height = 5)</span></span>
<span id="cb47-488"><a href="#cb47-488" aria-hidden="true" tabindex="-1"></a><span class="in">tmp0 %&gt;% ggplot(aes(x = repunit, y = mr)) + </span></span>
<span id="cb47-489"><a href="#cb47-489" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat = "identity", fill = "grey70", color = "black") +</span></span>
<span id="cb47-490"><a href="#cb47-490" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Reporting Group") + ylab("Mean residual") + theme_bw() +</span></span>
<span id="cb47-491"><a href="#cb47-491" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +</span></span>
<span id="cb47-492"><a href="#cb47-492" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_errorbar(aes(ymin = mr.025, ymax = mr.975), width = 0.4)</span></span>
<span id="cb47-493"><a href="#cb47-493" aria-hidden="true" tabindex="-1"></a><span class="in">dev.off()</span></span>
<span id="cb47-494"><a href="#cb47-494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-495"><a href="#cb47-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-496"><a href="#cb47-496" aria-hidden="true" tabindex="-1"></a>Plot estimated proportional contribution against true contribution for simulated mixtures for each reporting group:</span>
<span id="cb47-497"><a href="#cb47-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=7, fig.height=7}</span></span>
<span id="cb47-498"><a href="#cb47-498" aria-hidden="true" tabindex="-1"></a><span class="in">tmp &lt;- usr_sims$mixing_proportions %&gt;%</span></span>
<span id="cb47-499"><a href="#cb47-499" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(iter, repunit) %&gt;%</span></span>
<span id="cb47-500"><a href="#cb47-500" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(true_repprop = sum(true_pi), </span></span>
<span id="cb47-501"><a href="#cb47-501" aria-hidden="true" tabindex="-1"></a><span class="in">            reprop_posterior_mean = sum(post_mean_pi),</span></span>
<span id="cb47-502"><a href="#cb47-502" aria-hidden="true" tabindex="-1"></a><span class="in">            repu_n = sum(n)) %&gt;%</span></span>
<span id="cb47-503"><a href="#cb47-503" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(repu_n_prop = repu_n / sum(repu_n))</span></span>
<span id="cb47-504"><a href="#cb47-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-505"><a href="#cb47-505" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- ggplot(tmp, aes(x = true_repprop, y = reprop_posterior_mean, colour = repunit)) +</span></span>
<span id="cb47-506"><a href="#cb47-506" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(alpha = 0.2) +</span></span>
<span id="cb47-507"><a href="#cb47-507" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_abline(intercept = 0, slope = 1) +</span></span>
<span id="cb47-508"><a href="#cb47-508" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("True Mixing Proportion") + ylab("Posterior Mean Mixing Proportion") + </span></span>
<span id="cb47-509"><a href="#cb47-509" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap_paginate(~ repunit, nrow = 4, ncol = 4) +</span></span>
<span id="cb47-510"><a href="#cb47-510" aria-hidden="true" tabindex="-1"></a><span class="in">  guides(colour = FALSE)</span></span>
<span id="cb47-511"><a href="#cb47-511" aria-hidden="true" tabindex="-1"></a><span class="in"># pdf("Baseline Data and Testing/Simulated Mixtures/sim_mix_repgroup_scatter.pdf", width = 8, height = 8)</span></span>
<span id="cb47-512"><a href="#cb47-512" aria-hidden="true" tabindex="-1"></a><span class="in">for(i in 1:n_pages(p)) { print(p + facet_wrap_paginate(~ repunit, nrow = 4, ncol = 4, page = i)) }</span></span>
<span id="cb47-513"><a href="#cb47-513" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-514"><a href="#cb47-514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, message=FALSE, results='hide'}</span></span>
<span id="cb47-515"><a href="#cb47-515" aria-hidden="true" tabindex="-1"></a><span class="in">pdf("/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Simulated Mixtures/sim_mix_repgroup_scatter.pdf", width = 8, height = 8)</span></span>
<span id="cb47-516"><a href="#cb47-516" aria-hidden="true" tabindex="-1"></a><span class="in">for(i in 1:n_pages(p)) { print(p + facet_wrap_paginate(~ repunit, nrow = 4, ncol = 4, page = i)) }</span></span>
<span id="cb47-517"><a href="#cb47-517" aria-hidden="true" tabindex="-1"></a><span class="in">dev.off()</span></span>
<span id="cb47-518"><a href="#cb47-518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-519"><a href="#cb47-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-520"><a href="#cb47-520" aria-hidden="true" tabindex="-1"></a><span class="fu">### Z-scores</span></span>
<span id="cb47-521"><a href="#cb47-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-522"><a href="#cb47-522" aria-hidden="true" tabindex="-1"></a>Can we true the posteriors from individual fish? Plot distributions of z-scores by reporting group, over all simulations</span>
<span id="cb47-523"><a href="#cb47-523" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width = 9, fig.height = 5}</span></span>
<span id="cb47-524"><a href="#cb47-524" aria-hidden="true" tabindex="-1"></a><span class="in"># first summarize by reporting unit</span></span>
<span id="cb47-525"><a href="#cb47-525" aria-hidden="true" tabindex="-1"></a><span class="in">repu_pofzs &lt;- usr_sims$indiv_posteriors %&gt;%</span></span>
<span id="cb47-526"><a href="#cb47-526" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(repunit == simulated_repunit) %&gt;%</span></span>
<span id="cb47-527"><a href="#cb47-527" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(iter, indiv, simulated_repunit, repunit) %&gt;%  # first aggregate over reporting units</span></span>
<span id="cb47-528"><a href="#cb47-528" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(repu_PofZ = sum(PofZ)) %&gt;%</span></span>
<span id="cb47-529"><a href="#cb47-529" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() %&gt;%</span></span>
<span id="cb47-530"><a href="#cb47-530" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(repunit, simulated_repunit) %&gt;%</span></span>
<span id="cb47-531"><a href="#cb47-531" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(simulated_repunit = factor(simulated_repunit, levels = unique(simulated_repunit)))</span></span>
<span id="cb47-532"><a href="#cb47-532" aria-hidden="true" tabindex="-1"></a><span class="in"># also get the number of simulated individuals from each collection</span></span>
<span id="cb47-533"><a href="#cb47-533" aria-hidden="true" tabindex="-1"></a><span class="in">num_simmed &lt;- usr_sims$indiv_posteriors %&gt;%</span></span>
<span id="cb47-534"><a href="#cb47-534" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(iter, indiv) %&gt;%</span></span>
<span id="cb47-535"><a href="#cb47-535" aria-hidden="true" tabindex="-1"></a><span class="in">  slice(1) %&gt;%</span></span>
<span id="cb47-536"><a href="#cb47-536" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() %&gt;%</span></span>
<span id="cb47-537"><a href="#cb47-537" aria-hidden="true" tabindex="-1"></a><span class="in">  count(simulated_repunit)</span></span>
<span id="cb47-538"><a href="#cb47-538" aria-hidden="true" tabindex="-1"></a><span class="in"># now, plot it</span></span>
<span id="cb47-539"><a href="#cb47-539" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(repu_pofzs, aes(x = simulated_repunit, y = repu_PofZ)) +</span></span>
<span id="cb47-540"><a href="#cb47-540" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(colour = repunit)) +</span></span>
<span id="cb47-541"><a href="#cb47-541" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_text(data = num_simmed, mapping = aes(y = 1.025, label = n), angle = 90, hjust = 0, vjust = 0.5, size = 3) + </span></span>
<span id="cb47-542"><a href="#cb47-542" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 9, vjust = 0.5)) +</span></span>
<span id="cb47-543"><a href="#cb47-543" aria-hidden="true" tabindex="-1"></a><span class="in">  ylim(c(NA, 1.1)) +</span></span>
<span id="cb47-544"><a href="#cb47-544" aria-hidden="true" tabindex="-1"></a><span class="in">  guides(colour = FALSE)</span></span>
<span id="cb47-545"><a href="#cb47-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-546"><a href="#cb47-546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, message=FALSE, results='hide'}</span></span>
<span id="cb47-547"><a href="#cb47-547" aria-hidden="true" tabindex="-1"></a><span class="in">jpeg("/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Simulated Mixtures/sim_mix_indivpost_boxplot.jpg", res = 1000, units = "in", width = 9, height = 5)</span></span>
<span id="cb47-548"><a href="#cb47-548" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(repu_pofzs, aes(x = simulated_repunit, y = repu_PofZ)) +</span></span>
<span id="cb47-549"><a href="#cb47-549" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(colour = repunit)) +</span></span>
<span id="cb47-550"><a href="#cb47-550" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_text(data = num_simmed, mapping = aes(y = 1.025, label = n), angle = 90, hjust = 0, vjust = 0.5, size = 3) + </span></span>
<span id="cb47-551"><a href="#cb47-551" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 9, vjust = 0.5)) +</span></span>
<span id="cb47-552"><a href="#cb47-552" aria-hidden="true" tabindex="-1"></a><span class="in">  ylim(c(NA, 1.1)) +</span></span>
<span id="cb47-553"><a href="#cb47-553" aria-hidden="true" tabindex="-1"></a><span class="in">  guides(colour = FALSE)</span></span>
<span id="cb47-554"><a href="#cb47-554" aria-hidden="true" tabindex="-1"></a><span class="in">dev.off()</span></span>
<span id="cb47-555"><a href="#cb47-555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-556"><a href="#cb47-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-557"><a href="#cb47-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-558"><a href="#cb47-558" aria-hidden="true" tabindex="-1"></a><span class="fu">## 100% Simulations</span></span>
<span id="cb47-559"><a href="#cb47-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-560"><a href="#cb47-560" aria-hidden="true" tabindex="-1"></a>As noted elsewhere, 100% simulations are used less frequently than in the past as assumptions are unrealistic (i.e., assume mixtures only made up of individuals from a single reporting group). However, we perform them here as they provide another diagnostic tool to assess the performance of our baseline.</span>
<span id="cb47-561"><a href="#cb47-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-562"><a href="#cb47-562" aria-hidden="true" tabindex="-1"></a>Run the simulations and write output to file. 20 simulations per reporting group.</span>
<span id="cb47-565"><a href="#cb47-565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-566"><a href="#cb47-566" aria-hidden="true" tabindex="-1"></a><span class="co"># # create list specifying 100% mixtures</span></span>
<span id="cb47-567"><a href="#cb47-567" aria-hidden="true" tabindex="-1"></a><span class="co"># hundy_scenarios &lt;- lapply(unique(all_input$repunit)[!is.na(unique(all_input$repunit))], function(x) tibble(repunit = x, ppn = 1.0))</span></span>
<span id="cb47-568"><a href="#cb47-568" aria-hidden="true" tabindex="-1"></a><span class="co"># names(hundy_scenarios) &lt;- paste("All", unique(all_input$repunit)[!is.na(unique(all_input$repunit))], sep = "-")</span></span>
<span id="cb47-569"><a href="#cb47-569" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb47-570"><a href="#cb47-570" aria-hidden="true" tabindex="-1"></a><span class="co"># # run the 100% simulations</span></span>
<span id="cb47-571"><a href="#cb47-571" aria-hidden="true" tabindex="-1"></a><span class="co"># repu_hundy_results &lt;- assess_reference_loo(reference = ref_input, gen_start_col = 5, reps = 20, mixsize = 500, alpha_repunit = hundy_scenarios)</span></span>
<span id="cb47-572"><a href="#cb47-572" aria-hidden="true" tabindex="-1"></a><span class="co"># repu_hundy_results &lt;- repu_hundy_results %&gt;% mutate(repunit_true = substr(repunit_scenario, 5, 30))</span></span>
<span id="cb47-573"><a href="#cb47-573" aria-hidden="true" tabindex="-1"></a><span class="co"># repu_hundy_results_sum &lt;- repu_hundy_results %&gt;% filter(repunit_true == repunit) %&gt;% group_by(iter, repunit, repunit_true) %&gt;% summarize(post_ppn = sum(post_mean_pi))</span></span>
<span id="cb47-574"><a href="#cb47-574" aria-hidden="true" tabindex="-1"></a><span class="co"># repu_hundy_results_sum2 &lt;- repu_hundy_results_sum %&gt;% group_by(repunit_true) %&gt;% summarize(post_ppn_mean = mean(post_ppn), post_ppn_sd = sd(post_ppn))</span></span>
<span id="cb47-575"><a href="#cb47-575" aria-hidden="true" tabindex="-1"></a><span class="co"># mean(repu_hundy_results_sum2$post_ppn_mean)</span></span>
<span id="cb47-576"><a href="#cb47-576" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb47-577"><a href="#cb47-577" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(repu_hundy_results, "/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Hundred Perc Sims/sim_mix_100perc_results_raw.csv")</span></span>
<span id="cb47-578"><a href="#cb47-578" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(repu_hundy_results_sum2, "/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Hundred Perc Sims/sim_mix_100perc_results_summarized.csv")</span></span>
<span id="cb47-579"><a href="#cb47-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-580"><a href="#cb47-580" aria-hidden="true" tabindex="-1"></a>repu_hundy_results_sum2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Hundred Perc Sims/sim_mix_100perc_results_summarized.csv"</span>)</span>
<span id="cb47-581"><a href="#cb47-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-582"><a href="#cb47-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-583"><a href="#cb47-583" aria-hidden="true" tabindex="-1"></a>Plot the results (mean and standard deviation per reporting group). Should be near 100%. </span>
<span id="cb47-584"><a href="#cb47-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=9, fig.height=5}</span></span>
<span id="cb47-585"><a href="#cb47-585" aria-hidden="true" tabindex="-1"></a><span class="in">repu_hundy_results_sum2 %&gt;% ggplot() + </span></span>
<span id="cb47-586"><a href="#cb47-586" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(aes(x = repunit_true, y = post_ppn_mean), stat = "identity", fill = "grey70", color = "black") +</span></span>
<span id="cb47-587"><a href="#cb47-587" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_errorbar(aes(x = repunit_true, ymin = post_ppn_mean - post_ppn_sd, ymax = post_ppn_mean + post_ppn_sd), width = 0.4, color = "black") +</span></span>
<span id="cb47-588"><a href="#cb47-588" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Reporting Group") + ylab("100% Simulation Mixture Proportion") + theme_bw() +</span></span>
<span id="cb47-589"><a href="#cb47-589" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))</span></span>
<span id="cb47-590"><a href="#cb47-590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-591"><a href="#cb47-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-592"><a href="#cb47-592" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, message=FALSE, results='hide'}</span></span>
<span id="cb47-593"><a href="#cb47-593" aria-hidden="true" tabindex="-1"></a><span class="in">jpeg("/Users/jeffbaldock/Library/CloudStorage/GoogleDrive-jbaldock@uwyo.edu/Shared drives/wyo-coop-baldock/UWyoming/Snake River Cutthroat/Analyses/Snake River GSI Quarto/Baseline Testing/Hundred Perc Sims/sim_mix_100perc_accuracy.jpg", res = 1000, units = "in", width = 9, height = 5)</span></span>
<span id="cb47-594"><a href="#cb47-594" aria-hidden="true" tabindex="-1"></a><span class="in">repu_hundy_results_sum2 %&gt;% ggplot() + </span></span>
<span id="cb47-595"><a href="#cb47-595" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(aes(x = repunit_true, y = post_ppn_mean), stat = "identity", fill = "grey70", color = "black") +</span></span>
<span id="cb47-596"><a href="#cb47-596" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_errorbar(aes(x = repunit_true, ymin = post_ppn_mean - post_ppn_sd, ymax = post_ppn_mean + post_ppn_sd), width = 0.4, color = "black") +</span></span>
<span id="cb47-597"><a href="#cb47-597" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("Reporting Group") + ylab("100% Simulation Mixture Proportion") + theme_bw() +</span></span>
<span id="cb47-598"><a href="#cb47-598" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))</span></span>
<span id="cb47-599"><a href="#cb47-599" aria-hidden="true" tabindex="-1"></a><span class="in">dev.off()</span></span>
<span id="cb47-600"><a href="#cb47-600" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>